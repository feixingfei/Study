UPDATE pipelines
SET topic_id='1198959909841000448', name='DMS Mapping Cover To Product', `type`='insert-or-merge', prerequisite_enabled=1, prerequisite_on='{"filters": [{"left": {"kind": "topic", "topicId": "1198959909841000448", "factorId": "754afc14fda74742a695aeb7ecc0042c"}, "right": {"kind": "constant", "value": "true"}, "operator": "equals"}], "jointType": "and"}', stages='[{"name": "load data", "units": [{"do": [{"by": {"filters": [{"left": {"kind": "topic", "topicId": "1009975957886393344", "factorId": "2d728bf690b74aefad87079e9ad13e82"}, "right": {"kind": "topic", "topicId": "1198959909841000448", "factorId": "3c729c70833d416c8a790b486649e064"}, "operator": "equals"}], "jointType": "and"}, "type": "read-row", "message": "", "topicId": "1009975957886393344", "actionId": "1198990644505335809", "severity": "medium", "conditional": false, "variableName": "ma"}], "on": {"filters": [{"left": {"kind": "topic", "topicId": "1198959909841000448", "factorId": "3c729c70833d416c8a790b486649e064"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}], "jointType": "and"}, "name": "load ma", "unitId": "1198990644505335808", "conditional": true}, {"do": [{"type": "copy-to-memory", "source": {"kind": "computed", "type": "case-then", "parameters": [{"on": {"filters": [{"left": {"kind": "topic", "topicId": "1198959909841000448", "factorId": "8e459aebf7d7414684d240d9ea02b69c"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}], "jointType": "and"}, "kind": "topic", "topicId": "1198959909841000448", "factorId": "8e459aebf7d7414684d240d9ea02b69c", "conditional": true}, {"kind": "topic", "topicId": "1198959909841000448", "factorId": "67fb06d0e87f48b78dd14d1c28b29738", "conditional": false}]}, "message": "", "actionId": "1198987814029613059", "severity": "medium", "conditional": false, "variableName": "historyId"}, {"by": {"filters": [{"left": {"kind": "topic", "topicId": "1146507561823428608", "factorId": "b14e84baa1e240fea09895ee60ae917c"}, "right": {"kind": "constant", "value": "{historyId}"}, "operator": "equals"}], "jointType": "and"}, "type": "read-row", "message": "", "topicId": "1146507561823428608", "actionId": "1198990644505335810", "severity": "medium", "conditional": false, "variableName": "policyHistory"}], "on": {"filters": [{"left": {"kind": "topic", "topicId": "1198959909841000448", "factorId": "67fb06d0e87f48b78dd14d1c28b29738"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}, {"left": {"kind": "topic", "topicId": "1198959909841000448", "factorId": "8e459aebf7d7414684d240d9ea02b69c"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}], "jointType": "or"}, "name": "load policyHistory", "unitId": "1198987814029613058", "conditional": true}, {"do": [{"by": {"filters": [{"left": {"kind": "topic", "topicId": "1141795550690568192", "factorId": "ad84666fba9a486a80c7fc47a42f6446"}, "right": {"kind": "topic", "topicId": "1198959909841000448", "factorId": "f78f3c49c5ee473899f58717d8121008"}, "operator": "equals"}], "jointType": "and"}, "type": "read-row", "message": "", "topicId": "1141795550690568192", "actionId": "1198990644505335812", "severity": "medium", "conditional": false, "variableName": "declaration"}], "on": {"filters": [{"left": {"kind": "topic", "topicId": "1198959909841000448", "factorId": "f78f3c49c5ee473899f58717d8121008"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}], "jointType": "and"}, "name": "load ma declaration", "unitId": "1198990644505335811", "conditional": true}, {"do": [{"by": {"filters": [{"left": {"kind": "topic", "topicId": "1010517751620162560", "factorId": "bf394b771e7f423c831d859ee3742e85"}, "right": {"kind": "topic", "topicId": "1198959909841000448", "factorId": "8e459aebf7d7414684d240d9ea02b69c"}, "operator": "equals"}], "jointType": "and"}, "type": "read-row", "message": "", "topicId": "1010517751620162560", "actionId": "1199006488522250241", "severity": "medium", "conditional": false, "variableName": "endo"}], "on": {"filters": [{"left": {"kind": "topic", "topicId": "1198959909841000448", "factorId": "8e459aebf7d7414684d240d9ea02b69c"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}], "jointType": "and"}, "name": "load endo", "unitId": "1199006488522250240", "conditional": true}, {"do": [{"by": {"filters": [{"left": {"kind": "topic", "topicId": "1008775050838805504", "factorId": "d62dfa18c33446a08943ab8c48705499"}, "right": {"kind": "topic", "topicId": "1198959909841000448", "factorId": "67fb06d0e87f48b78dd14d1c28b29738"}, "operator": "equals"}], "jointType": "and"}, "type": "read-row", "message": "", "topicId": "1008775050838805504", "actionId": "1199006488522250243", "severity": "medium", "conditional": false, "variableName": "policy"}], "on": {"filters": [{"left": {"kind": "topic", "topicId": "1198959909841000448", "factorId": "67fb06d0e87f48b78dd14d1c28b29738"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}], "jointType": "and"}, "name": "load policy", "unitId": "1199006488522250242", "conditional": true}, {"do": [{"by": {"filters": [{"left": {"kind": "topic", "topicId": "1199673058676299776", "factorId": "9da00beb35f5409488fd422777ac1ed7"}, "right": {"kind": "topic", "topicId": "1198959909841000448", "factorId": "3d3c1a964df541269172567d5116cd78"}, "operator": "equals"}], "jointType": "and"}, "type": "read-row", "message": "", "topicId": "1199673058676299776", "actionId": "1200013278819565569", "severity": "medium", "conditional": false, "variableName": "maEndo"}], "on": {"filters": [{"left": {"kind": "topic", "topicId": "1198959909841000448", "factorId": "3d3c1a964df541269172567d5116cd78"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}], "jointType": "and"}, "name": "load maEndo", "unitId": "1200013278819565568", "conditional": true}, {"do": [{"type": "copy-to-memory", "source": {"kind": "computed", "type": "case-then", "parameters": [{"on": {"filters": [{"left": {"kind": "topic", "topicId": "1198959909841000448", "factorId": "3d3c1a964df541269172567d5116cd78"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}], "jointType": "and"}, "kind": "constant", "value": "MaEndo", "conditional": true}, {"on": {"filters": [{"left": {"kind": "topic", "topicId": "1198959909841000448", "factorId": "f78f3c49c5ee473899f58717d8121008"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}], "jointType": "and"}, "kind": "constant", "value": "Declaration", "conditional": true}, {"on": {"filters": [{"left": {"kind": "topic", "topicId": "1198959909841000448", "factorId": "67fb06d0e87f48b78dd14d1c28b29738"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}, {"left": {"kind": "topic", "topicId": "1198959909841000448", "factorId": "8e459aebf7d7414684d240d9ea02b69c"}, "right": {"kind": "constant", "value": ""}, "operator": "empty"}], "jointType": "and"}, "kind": "constant", "value": "Policy", "conditional": true}, {"on": {"filters": [{"left": {"kind": "topic", "topicId": "1198959909841000448", "factorId": "67fb06d0e87f48b78dd14d1c28b29738"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}, {"left": {"kind": "topic", "topicId": "1198959909841000448", "factorId": "8e459aebf7d7414684d240d9ea02b69c"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}], "jointType": "and"}, "kind": "constant", "value": "Endo", "conditional": true}]}, "message": "", "actionId": "1201892711817793537", "severity": "medium", "conditional": false, "variableName": "transType"}], "name": "get transType", "unitId": "1201892711817793536", "conditional": false}, {"do": [{"by": {"filters": [{"left": {"kind": "topic", "topicId": "1200101669221158912", "factorId": "ae4830afc67a44279cb098e3378e2891"}, "right": {"kind": "topic", "topicId": "1198959909841000448", "factorId": "3c729c70833d416c8a790b486649e064"}, "operator": "equals"}, {"left": {"kind": "topic", "topicId": "1200101669221158912", "factorId": "90f05f4b32b744038a113bce9eb4a81d"}, "right": {"kind": "constant", "value": "MA"}, "operator": "equals"}, {"left": {"kind": "topic", "topicId": "1200101669221158912", "factorId": "2bea211df4324fac8e289298d74a1bd7"}, "right": {"kind": "topic", "topicId": "1198959909841000448", "factorId": "a8a13a6dfd7749ea8bdda507a782ab83"}, "operator": "equals"}], "jointType": "and"}, "type": "exists", "message": "", "topicId": "1200101669221158912", "actionId": "1201959700926129153", "severity": "medium", "conditional": false, "variableName": "existMaCommRate"}], "on": {"filters": [{"left": {"kind": "constant", "value": "{transType}"}, "right": {"kind": "constant", "value": "Declaration"}, "operator": "equals"}], "jointType": "and"}, "name": "existMaCommRate", "unitId": "1201959700926129152", "conditional": true}, {"do": [{"by": {"filters": [{"left": {"kind": "topic", "topicId": "1200101669221158912", "factorId": "ae4830afc67a44279cb098e3378e2891"}, "right": {"kind": "topic", "topicId": "1198959909841000448", "factorId": "3c729c70833d416c8a790b486649e064"}, "operator": "equals"}, {"left": {"kind": "topic", "topicId": "1200101669221158912", "factorId": "90f05f4b32b744038a113bce9eb4a81d"}, "right": {"kind": "constant", "value": "MA"}, "operator": "equals"}, {"left": {"kind": "topic", "topicId": "1200101669221158912", "factorId": "2bea211df4324fac8e289298d74a1bd7"}, "right": {"kind": "topic", "topicId": "1198959909841000448", "factorId": "a8a13a6dfd7749ea8bdda507a782ab83"}, "operator": "equals"}], "jointType": "and"}, "type": "read-row", "source": {"kind": "constant", "value": ""}, "message": "", "topicId": "1200101669221158912", "actionId": "1201899051021750273", "severity": "medium", "conditional": false, "variableName": "maCommRate"}], "on": {"filters": [{"left": {"kind": "constant", "value": "{transType}"}, "right": {"kind": "constant", "value": "Declaration"}, "operator": "equals"}, {"left": {"kind": "constant", "value": "{existMaCommRate}"}, "right": {"kind": "constant", "value": "true"}, "operator": "equals"}], "jointType": "and"}, "name": "load maCommRate", "unitId": "1201899051021750272", "conditional": true}, {"do": [{"by": {"filters": [{"left": {"kind": "topic", "topicId": "1200101669221158912", "factorId": "94940584bc784522be871f77f3743098"}, "right": {"kind": "topic", "topicId": "1198959909841000448", "factorId": "3d3c1a964df541269172567d5116cd78"}, "operator": "equals"}, {"left": {"kind": "topic", "topicId": "1200101669221158912", "factorId": "2bea211df4324fac8e289298d74a1bd7"}, "right": {"kind": "topic", "topicId": "1198959909841000448", "factorId": "a8a13a6dfd7749ea8bdda507a782ab83"}, "operator": "equals"}, {"left": {"kind": "topic", "topicId": "1200101669221158912", "factorId": "90f05f4b32b744038a113bce9eb4a81d"}, "right": {"kind": "constant", "value": "MAENDO"}, "operator": "equals"}], "jointType": "and"}, "type": "exists", "message": "", "topicId": "1200101669221158912", "actionId": "1201959700926129155", "severity": "medium", "conditional": false, "variableName": "existMaEndoCommRate"}], "on": {"filters": [{"left": {"kind": "constant", "value": "{transType}"}, "right": {"kind": "constant", "value": "MaEndo"}, "operator": "equals"}], "jointType": "and"}, "name": "existMaEndoCommRate", "unitId": "1201959700926129154", "conditional": true}, {"do": [{"by": {"filters": [{"left": {"kind": "topic", "topicId": "1200101669221158912", "factorId": "94940584bc784522be871f77f3743098"}, "right": {"kind": "topic", "topicId": "1198959909841000448", "factorId": "3d3c1a964df541269172567d5116cd78"}, "operator": "equals"}, {"left": {"kind": "topic", "topicId": "1200101669221158912", "factorId": "2bea211df4324fac8e289298d74a1bd7"}, "right": {"kind": "topic", "topicId": "1198959909841000448", "factorId": "a8a13a6dfd7749ea8bdda507a782ab83"}, "operator": "equals"}, {"left": {"kind": "topic", "topicId": "1200101669221158912", "factorId": "90f05f4b32b744038a113bce9eb4a81d"}, "right": {"kind": "constant", "value": "MAENDO"}, "operator": "equals"}], "jointType": "and"}, "type": "read-row", "source": {"kind": "constant", "value": ""}, "message": "", "topicId": "1200101669221158912", "actionId": "1201899051021750275", "severity": "medium", "conditional": false, "variableName": "maEndoCommRate"}], "on": {"filters": [{"left": {"kind": "constant", "value": "{transType}"}, "right": {"kind": "constant", "value": "MaEndo"}, "operator": "equals"}, {"left": {"kind": "constant", "value": "{existMaEndoCommRate}"}, "right": {"kind": "constant", "value": "true"}, "operator": "equals"}], "jointType": "and"}, "name": "load maEndoCommRate", "unitId": "1201899051021750274", "conditional": true}, {"do": [{"by": {"filters": [{"left": {"kind": "topic", "topicId": "1200101669221158912", "factorId": "58404387427f4d2d97a4d37de93f0a58"}, "right": {"kind": "topic", "topicId": "1198959909841000448", "factorId": "67fb06d0e87f48b78dd14d1c28b29738"}, "operator": "equals"}, {"left": {"kind": "topic", "topicId": "1200101669221158912", "factorId": "2bea211df4324fac8e289298d74a1bd7"}, "right": {"kind": "topic", "topicId": "1198959909841000448", "factorId": "a8a13a6dfd7749ea8bdda507a782ab83"}, "operator": "equals"}, {"left": {"kind": "topic", "topicId": "1200101669221158912", "factorId": "90f05f4b32b744038a113bce9eb4a81d"}, "right": {"kind": "constant", "value": "POLICY"}, "operator": "equals"}], "jointType": "and"}, "type": "exists", "message": "", "topicId": "1200101669221158912", "actionId": "1201959700926129157", "severity": "medium", "conditional": false, "variableName": "existPolicyCommRate"}], "on": {"filters": [{"left": {"kind": "constant", "value": "{transType}"}, "right": {"kind": "constant", "value": "Policy"}, "operator": "equals"}], "jointType": "and"}, "name": "existPolicyCommRate", "unitId": "1201959700926129156", "conditional": true}, {"do": [{"by": {"filters": [{"left": {"kind": "topic", "topicId": "1200101669221158912", "factorId": "58404387427f4d2d97a4d37de93f0a58"}, "right": {"kind": "topic", "topicId": "1198959909841000448", "factorId": "67fb06d0e87f48b78dd14d1c28b29738"}, "operator": "equals"}, {"left": {"kind": "topic", "topicId": "1200101669221158912", "factorId": "2bea211df4324fac8e289298d74a1bd7"}, "right": {"kind": "topic", "topicId": "1198959909841000448", "factorId": "a8a13a6dfd7749ea8bdda507a782ab83"}, "operator": "equals"}, {"left": {"kind": "topic", "topicId": "1200101669221158912", "factorId": "90f05f4b32b744038a113bce9eb4a81d"}, "right": {"kind": "constant", "value": "POLICY"}, "operator": "equals"}], "jointType": "and"}, "type": "read-row", "message": "", "topicId": "1200101669221158912", "actionId": "1201899051021750277", "severity": "medium", "conditional": false, "variableName": "policyCommRate"}], "on": {"filters": [{"left": {"kind": "constant", "value": "{transType}"}, "right": {"kind": "constant", "value": "Policy"}, "operator": "equals"}, {"left": {"kind": "constant", "value": "{existPolicyCommRate}"}, "right": {"kind": "constant", "value": "true"}, "operator": "equals"}], "jointType": "and"}, "name": "load policyCommRate", "unitId": "1201899051021750276", "conditional": true}, {"do": [{"by": {"filters": [{"left": {"kind": "topic", "topicId": "1200101669221158912", "factorId": "cbc40ef904ad4ef5aace2e6616966c9f"}, "right": {"kind": "topic", "topicId": "1198959909841000448", "factorId": "8e459aebf7d7414684d240d9ea02b69c"}, "operator": "equals"}, {"left": {"kind": "topic", "topicId": "1200101669221158912", "factorId": "2bea211df4324fac8e289298d74a1bd7"}, "right": {"kind": "topic", "topicId": "1198959909841000448", "factorId": "a8a13a6dfd7749ea8bdda507a782ab83"}, "operator": "equals"}, {"left": {"kind": "topic", "topicId": "1200101669221158912", "factorId": "90f05f4b32b744038a113bce9eb4a81d"}, "right": {"kind": "constant", "value": "ENDO"}, "operator": "equals"}], "jointType": "and"}, "type": "exists", "message": "", "topicId": "1200101669221158912", "actionId": "1201959700926129159", "severity": "medium", "conditional": false, "variableName": "existEndoCommRate"}], "on": {"filters": [{"left": {"kind": "constant", "value": "{transType}"}, "right": {"kind": "constant", "value": "Endo"}, "operator": "equals"}], "jointType": "and"}, "name": "existEndoCommRate", "unitId": "1201959700926129158", "conditional": true}, {"do": [{"by": {"filters": [{"left": {"kind": "topic", "topicId": "1200101669221158912", "factorId": "cbc40ef904ad4ef5aace2e6616966c9f"}, "right": {"kind": "topic", "topicId": "1198959909841000448", "factorId": "8e459aebf7d7414684d240d9ea02b69c"}, "operator": "equals"}, {"left": {"kind": "topic", "topicId": "1200101669221158912", "factorId": "2bea211df4324fac8e289298d74a1bd7"}, "right": {"kind": "topic", "topicId": "1198959909841000448", "factorId": "a8a13a6dfd7749ea8bdda507a782ab83"}, "operator": "equals"}, {"left": {"kind": "topic", "topicId": "1200101669221158912", "factorId": "90f05f4b32b744038a113bce9eb4a81d"}, "right": {"kind": "constant", "value": "ENDO"}, "operator": "equals"}], "jointType": "and"}, "type": "read-row", "message": "", "topicId": "1200101669221158912", "actionId": "1201899051021750279", "severity": "medium", "conditional": false, "variableName": "endoCommRate"}], "on": {"filters": [{"left": {"kind": "constant", "value": "{transType}"}, "right": {"kind": "constant", "value": "Endo"}, "operator": "equals"}, {"left": {"kind": "constant", "value": "{existEndoCommRate}"}, "right": {"kind": "constant", "value": "true"}, "operator": "equals"}], "jointType": "and"}, "name": "load endoCommRate", "unitId": "1201899051021750278", "conditional": true}, {"do": [{"type": "copy-to-memory", "source": {"kind": "computed", "type": "case-then", "parameters": [{"on": {"filters": [{"left": {"kind": "constant", "value": "{transType}"}, "right": {"kind": "constant", "value": "MaEndo"}, "operator": "equals"}], "jointType": "and"}, "kind": "constant", "value": "{maEndoCommRate}", "conditional": true}, {"on": {"filters": [{"left": {"kind": "constant", "value": "{transType}"}, "right": {"kind": "constant", "value": "Declaration"}, "operator": "equals"}], "jointType": "and"}, "kind": "constant", "value": "{maCommRate}", "conditional": true}, {"on": {"filters": [{"left": {"kind": "constant", "value": "{transType}"}, "right": {"kind": "constant", "value": "Policy"}, "operator": "equals"}], "jointType": "and"}, "kind": "constant", "value": "{policyCommRate}", "conditional": true}, {"on": {"filters": [{"left": {"kind": "constant", "value": "{transType}"}, "right": {"kind": "constant", "value": "Endo"}, "operator": "equals"}], "jointType": "and"}, "kind": "constant", "value": "{endoCommRate}", "conditional": true}]}, "message": "", "actionId": "1201899051021750281", "severity": "medium", "conditional": false, "variableName": "commissionRate"}], "name": "load commissionRate", "unitId": "1201899051021750280", "conditional": false}], "stageId": "1198987814029613057", "conditional": false}, {"name": "mapping fields", "units": [{"do": [{"type": "copy-to-memory", "source": {"kind": "computed", "type": "case-then", "parameters": [{"on": {"filters": [{"left": {"kind": "topic", "topicId": "1198959909841000448", "factorId": "3c729c70833d416c8a790b486649e064"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}], "jointType": "and"}, "kind": "constant", "value": "{ma.maNo}", "conditional": true}, {"kind": "constant", "value": "{policyHistory.quoteNumber}", "conditional": false}]}, "message": "", "actionId": "1198990644509530112", "severity": "medium", "conditional": false, "variableName": "policyNumber"}], "name": "policyNumber", "unitId": "1198990644505335814", "conditional": false}, {"do": [{"type": "copy-to-memory", "source": {"kind": "computed", "type": "case-then", "parameters": [{"on": {"filters": [{"left": {"kind": "topic", "topicId": "1198959909841000448", "factorId": "3c729c70833d416c8a790b486649e064"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}, {"left": {"kind": "topic", "topicId": "1198959909841000448", "factorId": "67fb06d0e87f48b78dd14d1c28b29738"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}], "jointType": "and"}, "kind": "constant", "value": "{policyHistory.quoteNumber}", "conditional": true}]}, "message": "", "actionId": "1199006488522250245", "severity": "medium", "conditional": false, "variableName": "certificateNo"}], "name": "certificateNo", "unitId": "1199006488522250244", "conditional": false}, {"do": [{"type": "copy-to-memory", "source": {"kind": "computed", "type": "case-then", "parameters": [{"on": {"filters": [{"left": {"kind": "topic", "topicId": "1198959909841000448", "factorId": "3c729c70833d416c8a790b486649e064"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}, {"left": {"kind": "topic", "topicId": "1198959909841000448", "factorId": "67fb06d0e87f48b78dd14d1c28b29738"}, "right": {"kind": "constant", "value": ""}, "operator": "empty"}], "jointType": "and"}, "kind": "constant", "value": "{ma.effDate}", "conditional": true}, {"kind": "constant", "value": "{policyHistory.effectiveDate}", "conditional": false}]}, "message": "", "actionId": "1199006488522250247", "severity": "medium", "conditional": false, "variableName": "effectiveDate"}], "name": "effectiveDate", "unitId": "1199006488522250246", "conditional": false}, {"do": [{"type": "copy-to-memory", "source": {"kind": "computed", "type": "case-then", "parameters": [{"on": {"filters": [{"left": {"kind": "topic", "topicId": "1198959909841000448", "factorId": "3c729c70833d416c8a790b486649e064"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}, {"left": {"kind": "topic", "topicId": "1198959909841000448", "factorId": "67fb06d0e87f48b78dd14d1c28b29738"}, "right": {"kind": "constant", "value": ""}, "operator": "empty"}], "jointType": "and"}, "kind": "constant", "value": "{ma.issueDate}", "conditional": true}, {"kind": "constant", "value": "{policyHistory.policyIssueDt}", "conditional": false}]}, "message": "", "actionId": "1199006488522250249", "severity": "medium", "conditional": false, "variableName": "issuedAt"}], "name": "issuedAt", "unitId": "1199006488522250248", "conditional": false}, {"do": [{"type": "copy-to-memory", "source": {"kind": "computed", "type": "case-then", "parameters": [{"on": {"filters": [{"left": {"kind": "topic", "topicId": "1198959909841000448", "factorId": "3d3c1a964df541269172567d5116cd78"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}], "jointType": "and"}, "kind": "constant", "value": "{maEndo.issue_date}", "conditional": true}, {"on": {"filters": [{"left": {"kind": "topic", "topicId": "1198959909841000448", "factorId": "f78f3c49c5ee473899f58717d8121008"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}], "jointType": "and"}, "kind": "constant", "value": "{declaration.completedAt}", "conditional": true}, {"on": {"filters": [{"left": {"kind": "topic", "topicId": "1198959909841000448", "factorId": "3c729c70833d416c8a790b486649e064"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}], "jointType": "and"}, "kind": "constant", "value": "{ma.issueDate}", "conditional": true}, {"kind": "constant", "value": "{policyHistory.policyIssueDt}", "conditional": false}]}, "message": "", "actionId": "1209154358349498369", "severity": "medium", "conditional": false, "variableName": "businessDate"}, {"type": "copy-to-memory", "source": {"kind": "computed", "type": "case-then", "parameters": [{"on": {"filters": [{"left": {"kind": "topic", "topicId": "1198959909841000448", "factorId": "f78f3c49c5ee473899f58717d8121008"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}, {"left": {"kind": "constant", "value": "{declaration.completedAt}"}, "right": {"kind": "constant", "value": ""}, "operator": "empty"}], "jointType": "and"}, "kind": "constant", "value": "{declaration.createdAt}", "conditional": true}, {"kind": "constant", "value": "{businessDate}", "conditional": false}]}, "message": "", "actionId": "1217049513735445504", "severity": "medium", "conditional": false, "variableName": "businessDate"}], "name": "businessDate", "unitId": "1209154358349498368", "conditional": false}, {"do": [{"type": "copy-to-memory", "source": {"kind": "computed", "type": "case-then", "parameters": [{"on": {"filters": [{"left": {"kind": "topic", "topicId": "1198959909841000448", "factorId": "3c729c70833d416c8a790b486649e064"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}], "jointType": "and"}, "kind": "constant", "value": "{ma.createdAt}", "conditional": true}, {"kind": "constant", "value": "{policy.createdAt}", "conditional": false}]}, "message": "", "actionId": "1199006488522250251", "severity": "medium", "conditional": false, "variableName": "submissionDate"}], "name": "submissionDate", "unitId": "1199006488522250250", "conditional": false}, {"do": [{"type": "copy-to-memory", "source": {"kind": "computed", "type": "case-then", "parameters": [{"on": {"filters": [{"left": {"kind": "constant", "value": "{ma.maType}"}, "right": {"kind": "constant", "value": "CUST_EB"}, "operator": "equals"}, {"left": {"kind": "constant", "value": "{ma.billingSchedule}"}, "right": {"kind": "constant", "value": "LUMPSUM"}, "operator": "not-equals"}], "jointType": "and"}, "kind": "constant", "value": "INSTALLMENT", "conditional": true}, {"on": {"filters": [{"left": {"kind": "topic", "topicId": "1198959909841000448", "factorId": "3c729c70833d416c8a790b486649e064"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}], "jointType": "and"}, "kind": "constant", "value": "LUMPSUM", "conditional": true}, {"kind": "constant", "value": "{policyHistory.paymentFrequency}", "conditional": false}]}, "message": "", "actionId": "1199006488522250253", "severity": "medium", "conditional": false, "variableName": "paymentFrequency"}, {"type": "copy-to-memory", "source": {"kind": "computed", "type": "case-then", "parameters": [{"on": {"filters": [{"left": {"kind": "topic", "topicId": "1198959909841000448", "factorId": "3c729c70833d416c8a790b486649e064"}, "right": {"kind": "constant", "value": "false"}, "operator": "not-empty"}, {"left": {"kind": "constant", "value": "{policy.isLongTermLife}"}, "right": {"kind": "constant", "value": "false"}, "operator": "equals"}], "jointType": "or"}, "kind": "constant", "value": "{paymentFrequency}", "conditional": true}, {"on": {"filters": [{"left": {"kind": "constant", "value": "{policyHistory.recurringSchedule}"}, "right": {"kind": "constant", "value": "MONTHLY"}, "operator": "equals"}], "jointType": "and"}, "kind": "constant", "value": "MONTH", "conditional": true}, {"on": {"filters": [{"left": {"kind": "constant", "value": "{policyHistory.recurringSchedule}"}, "right": {"kind": "constant", "value": "QUARTERLY"}, "operator": "equals"}], "jointType": "and"}, "kind": "constant", "value": "QUARTER", "conditional": true}, {"on": {"filters": [{"left": {"kind": "constant", "value": "{policyHistory.recurringSchedule}"}, "right": {"kind": "constant", "value": "SEMI-YEARLY"}, "operator": "equals"}], "jointType": "and"}, "kind": "constant", "value": "HALFYEAR", "conditional": true}, {"on": {"filters": [{"left": {"kind": "constant", "value": "{policyHistory.recurringSchedule}"}, "right": {"kind": "constant", "value": "YEARLY"}, "operator": "equals"}], "jointType": "and"}, "kind": "constant", "value": "YEAR", "conditional": true}, {"kind": "constant", "value": "{policyHistory.recurringSchedule}", "conditional": false}]}, "message": "", "actionId": "1212820738785204224", "severity": "medium", "conditional": false, "variableName": "paymentFrequency"}], "name": "paymentFrequency", "unitId": "1199006488522250252", "conditional": false}, {"do": [{"type": "copy-to-memory", "source": {"kind": "computed", "type": "case-then", "parameters": [{"on": {"filters": [{"left": {"kind": "topic", "topicId": "1198959909841000448", "factorId": "8e459aebf7d7414684d240d9ea02b69c"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}, {"left": {"kind": "constant", "value": "{endo.endoType}"}, "right": {"kind": "constant", "value": "INCEPTION_CANCEL,MIDWAY_CANCEL"}, "operator": "in"}, {"left": {"kind": "topic", "topicId": "1198959909841000448", "factorId": "3c729c70833d416c8a790b486649e064"}, "right": {"kind": "constant", "value": ""}, "operator": "empty"}], "jointType": "and"}, "kind": "constant", "value": "CANCELLED", "conditional": true}, {"kind": "constant", "value": "ISSUED", "conditional": false}]}, "message": "", "actionId": "1199006488522250257", "severity": "medium", "conditional": false, "variableName": "policyStatus"}], "name": "policyStatus", "unitId": "1199006488522250256", "conditional": false}, {"do": [{"type": "copy-to-memory", "source": {"kind": "constant", "value": "{endo.cancelReason}"}, "message": "", "actionId": "1199006488522250259", "severity": "medium", "conditional": false, "variableName": "cancelReason"}], "on": {"filters": [{"left": {"kind": "topic", "topicId": "1198959909841000448", "factorId": "8e459aebf7d7414684d240d9ea02b69c"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}, {"left": {"kind": "constant", "value": "{endo.endoType}"}, "right": {"kind": "constant", "value": "INCEPTION_CANCEL,MIDWAY_CANCEL"}, "operator": "in"}, {"left": {"kind": "topic", "topicId": "1198959909841000448", "factorId": "3c729c70833d416c8a790b486649e064"}, "right": {"kind": "constant", "value": ""}, "operator": "empty"}], "jointType": "and"}, "name": "cancelReason", "unitId": "1199006488522250258", "conditional": true}, {"do": [{"type": "copy-to-memory", "source": {"kind": "computed", "type": "case-then", "parameters": [{"on": {"filters": [{"left": {"kind": "constant", "value": "{policy.isLongTermLife}"}, "right": {"kind": "constant", "value": "true"}, "operator": "equals"}], "jointType": "and"}, "kind": "constant", "value": "NA", "conditional": true}]}, "message": "", "actionId": "1199006488522250261", "severity": "medium", "conditional": false, "variableName": "streamStatus"}], "name": "streamStatus", "unitId": "1199006488522250260", "conditional": false}, {"do": [{"type": "copy-to-memory", "source": {"kind": "computed", "type": "case-then", "parameters": [{"on": {"filters": [{"left": {"kind": "topic", "topicId": "1198959909841000448", "factorId": "a8a13a6dfd7749ea8bdda507a782ab83"}, "right": {"kind": "constant", "value": "WORK_MEDIC"}, "operator": "equals"}], "jointType": "and"}, "kind": "constant", "value": "HSPT", "conditional": true}, {"on": {"filters": [{"left": {"kind": "topic", "topicId": "1198959909841000448", "factorId": "a8a13a6dfd7749ea8bdda507a782ab83"}, "right": {"kind": "constant", "value": "DEATH"}, "operator": "equals"}], "jointType": "and"}, "kind": "constant", "value": "GPAS", "conditional": true}, {"on": {"filters": [{"left": {"kind": "topic", "topicId": "1198959909841000448", "factorId": "a8a13a6dfd7749ea8bdda507a782ab83"}, "right": {"kind": "constant", "value": "MATERIAL_DAMAGE"}, "operator": "equals"}], "jointType": "and"}, "kind": "constant", "value": "MD", "conditional": true}, {"kind": "topic", "topicId": "1198959909841000448", "factorId": "a8a13a6dfd7749ea8bdda507a782ab83", "conditional": false}]}, "message": "", "actionId": "1199006488522250263", "severity": "medium", "conditional": false, "variableName": "coverageCode"}], "name": "coverageCode", "unitId": "1199006488522250262", "conditional": false}, {"do": [{"type": "copy-to-memory", "source": {"kind": "computed", "type": "case-then", "parameters": [{"on": {"filters": [{"left": {"kind": "topic", "topicId": "1198959909841000448", "factorId": "f78f3c49c5ee473899f58717d8121008"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}], "jointType": "and"}, "kind": "constant", "value": "DL{declaration.declarationNo}", "conditional": true}, {"on": {"filters": [{"left": {"kind": "topic", "topicId": "1198959909841000448", "factorId": "3d3c1a964df541269172567d5116cd78"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}], "jointType": "and"}, "kind": "constant", "value": "ED{maEndo.endo_no}", "conditional": true}, {"on": {"filters": [{"left": {"kind": "topic", "topicId": "1198959909841000448", "factorId": "8e459aebf7d7414684d240d9ea02b69c"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}], "jointType": "and"}, "kind": "constant", "value": "ED{endo.endoNo}", "conditional": true}, {"kind": "constant", "value": "{policy.bizType}{policy.policyNumber}", "conditional": false}]}, "message": "", "actionId": "1199006488522250267", "severity": "medium", "conditional": false, "variableName": "transactionReferenceNumber"}], "name": "transactionReferenceNumber", "unitId": "1199006488522250266", "conditional": false}, {"do": [{"type": "copy-to-memory", "source": {"kind": "computed", "type": "case-then", "parameters": [{"on": {"filters": [{"left": {"kind": "constant", "value": "{commissionRate.revised_rate}"}, "right": {"kind": "constant", "value": "{commissionRate.default_rate}"}, "operator": "equals"}], "jointType": "and"}, "kind": "constant", "value": "NO", "conditional": true}, {"kind": "constant", "value": "YES", "conditional": false}]}, "message": "", "actionId": "1201899051021750283", "severity": "medium", "conditional": false, "variableName": "commissionRateChangeFlag"}], "name": "commissionRateChangeFlag", "unitId": "1201899051021750282", "conditional": false}], "stageId": "1198990644505335813", "conditional": false}, {"name": "mapping data to product", "units": [{"do": [{"by": {"filters": [{"left": {"kind": "topic", "topicId": "1151121434622877696", "factorId": "a3752f10779c48a1862dcc06936d6f67"}, "right": {"kind": "topic", "topicId": "1198959909841000448", "factorId": "d197defe61b249349b1a20faca347249"}, "operator": "equals"}], "jointType": "and"}, "type": "insert-or-merge-row", "mapping": [{"source": {"kind": "topic", "topicId": "1198959909841000448", "factorId": "d197defe61b249349b1a20faca347249"}, "factorId": "a3752f10779c48a1862dcc06936d6f67", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "{policyNumber}"}, "factorId": "de77a80c8cf24d49a6a7c6457cc099ba", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "{declaration.declarationNo}"}, "factorId": "d39c92a3d4ef41c29aa35bb5610c38ef", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "{certificateNo}"}, "factorId": "5f497b501b044a1bb30a23d1f562efe9", "arithmetic": "none"}, {"source": {"kind": "topic", "topicId": "1198959909841000448", "factorId": "3b49d604ccf142789ecd447ae0ce8601"}, "factorId": "abd362c18f2a4cc88a04bf788fab7f2b", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "{coverageCode}"}, "factorId": "7e631cc1c679405e8aa34b503e048489", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "PLAN"}, "factorId": "2277254b05334cc8bb35b51657b149a4", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "{effectiveDate}"}, "factorId": "4cedf7f1069e44408ad0d389b6737eb5", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "{issuedAt}"}, "factorId": "840bab9f973542ca893619c633d899ef", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "{submissionDate}"}, "factorId": "03dd436611a440bca4fc3bcd4c5222b1", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "{paymentFrequency}"}, "factorId": "608fdab1b3e845d89980234a8500f526", "arithmetic": "none"}, {"source": {"kind": "constant", "value": ""}, "factorId": "58144a813da4425da88ce351df51fb72", "arithmetic": "none"}, {"source": {"kind": "constant", "value": ""}, "factorId": "bdea7d65db1c4fa3bc216559bea646fb", "arithmetic": "none"}, {"source": {"kind": "topic", "topicId": "1198959909841000448", "factorId": "8f1d853cc5184558a597a4fa5274c09c"}, "factorId": "c4711f2171a6432c8db22d65b5fefc30", "arithmetic": "none"}, {"source": {"kind": "topic", "topicId": "1198959909841000448", "factorId": "6275474452f34b37b0224b2707fc7b37"}, "factorId": "3e1052b5bc774a9da439b1708fadbbcf", "arithmetic": "none"}, {"source": {"kind": "constant", "value": ""}, "factorId": "94507d542ba94e41a2881f3332ab0c98", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "0"}, "factorId": "a16dc997caf34917b159a1c8d238f1b2", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "0"}, "factorId": "6215d3465f6843c2bffd928f7fd10f93", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "0"}, "factorId": "c4fd33c4be6544cc8d257cba5cc24374", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "0"}, "factorId": "7fab2f60b04849aaada5033b1c2c51c0", "arithmetic": "none"}, {"source": {"kind": "topic", "topicId": "1198959909841000448", "factorId": "d59230d8885241bdb7e7498b38be2165"}, "factorId": "382e5a2cc34a4064b6078d3675e3ebb8", "arithmetic": "none"}, {"source": {"kind": "topic", "topicId": "1198959909841000448", "factorId": "508f4a3e5f8d43ffa5153241859a4c8c"}, "factorId": "0bbfe90174734cd4947a7444ee935976", "arithmetic": "none"}, {"source": {"kind": "constant", "value": ""}, "factorId": "50959bf9cffd46fdb49ebb421af96862", "arithmetic": "none"}, {"source": {"kind": "constant", "value": ""}, "factorId": "a6689e361cd747c69bde6b241c2b6278", "arithmetic": "none"}, {"source": {"kind": "computed", "type": "case-then", "parameters": [{"on": {"filters": [{"left": {"kind": "constant", "value": "{commissionRate.revised_rate}"}, "right": {"kind": "constant", "value": ""}, "operator": "empty"}], "jointType": "and"}, "kind": "constant", "value": "0", "conditional": true}, {"kind": "constant", "value": "{commissionRate.revised_rate}", "conditional": false}]}, "factorId": "13372d21f199404a83c120fce9d8d50a", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "{commissionRateChangeFlag}"}, "factorId": "77981058f57646df86512b91e7d45fc3", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "{policyStatus}"}, "factorId": "d45d858498bc4c9082187e8d281be933", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "{cancelReason}"}, "factorId": "692300e8583c4a499752050b627ac50a", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "{streamStatus}"}, "factorId": "b5fad9f1744a4e2b9cd0d81cef658f25", "arithmetic": "none"}, {"source": {"kind": "topic", "topicId": "1198959909841000448", "factorId": "79a21096e6db44cf89c0ed1c2634639e"}, "factorId": "8b4c62ff0ea4477995fc9b29cc281ea6", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "{transactionReferenceNumber}"}, "factorId": "0e979c9107384bd29693b2ded28eaf6c", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "{businessDate}"}, "factorId": "232eb0227a314f27be6cca30f70ccb7f", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "BIX"}, "factorId": "9359a5953c2e46d8b96d3267a075fb3d", "arithmetic": "none"}], "message": "", "topicId": "1151121434622877696", "actionId": "1198990644509530115", "severity": "medium", "conditional": false}], "name": "mapping data", "unitId": "1198990644509530114", "conditional": false}], "stageId": "1198990644509530113", "conditional": false}]', enabled=1, validated=1, tenant_id='1013492659824011264', created_at='2024-01-22 05:49:30', created_by='1013492910945380352', last_modified_at='2024-03-13 09:44:04', last_modified_by='1013492910945380352', version=38
WHERE pipeline_id='1198987814029613056';

UPDATE pipelines
SET topic_id='1009977843108600832', name='Collect DMS Premium Mapping', `type`='insert-or-merge', prerequisite_enabled=1, prerequisite_on='{"filters": [{"left": {"kind": "topic", "topicId": "1009977843108600832", "factorId": "90f25ae3652a4b12b2f3a0ccec53ceda"}, "right": {"kind": "constant", "value": "BILL_COLLECT"}, "operator": "equals"}, {"left": {"kind": "topic", "topicId": "1009977843108600832", "factorId": "9837e4fe04ca4423befd494bf6edec10"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}, {"left": {"kind": "topic", "topicId": "1009977843108600832", "factorId": "4f6f0b2feede4647b3fc39edc60a7ec3"}, "right": {"kind": "constant", "value": "true"}, "operator": "equals"}], "jointType": "and"}', stages='[{"name": "load data", "units": [{"do": [{"by": {"filters": [{"left": {"kind": "topic", "topicId": "1009977843108600832", "factorId": "7a807746ff4749aa901eacb1d55acd96"}, "right": {"kind": "topic", "topicId": "1009976609668652032", "factorId": "756ceb4333134053882c87e76b004309"}, "operator": "equals"}], "jointType": "and"}, "type": "read-row", "source": {"kind": "constant", "value": ""}, "message": "", "topicId": "1009976609668652032", "actionId": "1160619034997115905", "severity": "medium", "conditional": false, "variableName": "collect"}], "name": "load collect", "unitId": "1160619034997115904", "conditional": false}, {"do": [{"by": {"filters": [{"left": {"kind": "topic", "topicId": "1009977843108600832", "factorId": "9837e4fe04ca4423befd494bf6edec10"}, "right": {"kind": "topic", "topicId": "1010301439824352256", "factorId": "a5a25793c4a24c8683fe2b00cd76bad5"}, "operator": "equals"}], "jointType": "and"}, "type": "read-row", "source": {"kind": "topic", "topicId": "1009977843108600832", "factorId": ""}, "message": "", "topicId": "1010301439824352256", "actionId": "1160602852202073091", "severity": "medium", "conditional": false, "variableName": "bill"}], "name": "load bill", "unitId": "1160602852202073090", "conditional": false}, {"do": [{"by": {"filters": [{"left": {"kind": "topic", "topicId": "1141797703400318976", "factorId": "cc0ef369fcf94abc90146dba2f04355d"}, "right": {"kind": "constant", "value": "{bill.lifePolicyRenewalId}"}, "operator": "equals"}], "jointType": "and"}, "type": "read-row", "source": {"kind": "constant", "value": ""}, "message": "", "topicId": "1141797703400318976", "actionId": "1210275376224818177", "severity": "medium", "conditional": false, "variableName": "lifePolicyRenewal"}], "on": {"filters": [{"left": {"kind": "constant", "value": "{bill.lifePolicyRenewalId}"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}], "jointType": "and"}, "name": "load lifePolicyRenewal", "unitId": "1210275376224818176", "conditional": true}, {"do": [{"type": "copy-to-memory", "source": {"kind": "computed", "type": "case-then", "parameters": [{"on": {"filters": [{"left": {"kind": "constant", "value": "{collect.status}"}, "right": {"kind": "constant", "value": "REVERSED"}, "operator": "equals"}, {"left": {"kind": "topic", "topicId": "1009977843108600832", "factorId": "1cfcbee80b6a4294a85677d939bf4009"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}], "jointType": "and"}, "kind": "constant", "value": "FULLYPAIDREVERSAL", "conditional": true}, {"kind": "constant", "value": "FULLYPAID", "conditional": false}]}, "message": "", "actionId": "1160619034997115907", "severity": "medium", "conditional": false, "variableName": "alterationType"}, {"type": "copy-to-memory", "source": {"kind": "computed", "type": "case-then", "parameters": [{"on": {"filters": [{"left": {"kind": "constant", "value": "{collect.status}"}, "right": {"kind": "constant", "value": "REVERSED"}, "operator": "equals"}, {"left": {"kind": "topic", "topicId": "1009977843108600832", "factorId": "1cfcbee80b6a4294a85677d939bf4009"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}], "jointType": "and"}, "kind": "constant", "value": "{collect.createdAt}", "conditional": true}, {"kind": "constant", "value": "{collect.collectedAt}", "conditional": false}]}, "message": "", "actionId": "1160619034997115908", "severity": "medium", "conditional": false, "variableName": "appropriationDate"}, {"type": "copy-to-memory", "source": {"kind": "computed", "type": "case-then", "parameters": [{"on": {"filters": [{"left": {"kind": "constant", "value": "{collect.status}"}, "right": {"kind": "constant", "value": "REVERSED"}, "operator": "equals"}, {"left": {"kind": "topic", "topicId": "1009977843108600832", "factorId": "1cfcbee80b6a4294a85677d939bf4009"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}], "jointType": "and"}, "kind": "constant", "value": "ACCRUAL", "conditional": true}, {"kind": "constant", "value": "PAID", "conditional": false}]}, "message": "", "actionId": "1160627997742418944", "severity": "medium", "conditional": false, "variableName": "appropriationType"}, {"type": "copy-to-memory", "source": {"kind": "computed", "type": "case-then", "parameters": [{"on": {"filters": [{"left": {"kind": "constant", "value": "{bill.ma_no}"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}], "jointType": "and"}, "kind": "constant", "value": "{bill.ma_no}", "conditional": true}, {"kind": "constant", "value": "{bill.policy_no}", "conditional": false}]}, "message": "", "actionId": "1160619034997115909", "severity": "medium", "conditional": false, "variableName": "policyNum"}], "name": "mapping value", "unitId": "1160619034997115906", "conditional": false}, {"do": [{"type": "copy-to-memory", "source": {"kind": "computed", "type": "case-then", "parameters": [{"on": {"filters": [{"left": {"kind": "constant", "value": "{bill.bizType}"}, "right": {"kind": "constant", "value": "ENDO"}, "operator": "equals"}], "jointType": "and"}, "kind": "constant", "value": "ED{bill.endo_no}", "conditional": true}, {"on": {"filters": [{"left": {"kind": "constant", "value": "{bill.declaration_no}"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}], "jointType": "and"}, "kind": "constant", "value": "DL{bill.declaration_no}", "conditional": true}, {"kind": "constant", "value": "{bill.bizType}{policyNum}", "conditional": false}]}, "message": "", "actionId": "1160619034997115911", "severity": "medium", "conditional": false, "variableName": "transactionReferenceNumber"}], "name": "transaction ref no.", "unitId": "1160619034997115910", "conditional": false}, {"do": [{"type": "copy-to-memory", "source": {"kind": "computed", "type": "case-then", "parameters": [{"on": {"filters": [{"left": {"kind": "constant", "value": "{bill.lifePolicyRenewalId}"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}], "jointType": "and"}, "kind": "constant", "value": "{lifePolicyRenewal.effDate}", "conditional": true}, {"kind": "constant", "value": "{bill.due_date}", "conditional": false}]}, "message": "", "actionId": "1210275376224818179", "severity": "medium", "conditional": false, "variableName": "dueDate"}], "name": "dueDate", "unitId": "1210275376224818178", "conditional": false}, {"do": [{"type": "copy-to-memory", "source": {"kind": "computed", "type": "case-then", "parameters": [{"on": {"filters": [{"left": {"kind": "constant", "value": "{bill.lifePolicyRenewalId}"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}], "jointType": "and"}, "kind": "constant", "value": "{lifePolicyRenewal.seq}", "conditional": true}, {"kind": "constant", "value": "{bill.billSeq}", "conditional": false}]}, "message": "", "actionId": "1210521912829563905", "severity": "medium", "conditional": false, "variableName": "installmentNo"}], "name": "installmentNo", "unitId": "1210521912829563904", "conditional": false}, {"do": [{"by": {"filters": [{"left": {"kind": "topic", "topicId": "1009977843108600832", "factorId": "c12304362cc34a21a90544c143e98223"}, "right": {"kind": "topic", "topicId": "1151162844587810816", "factorId": "6d9bc8325c25439098fdeac0d6bb1263"}, "operator": "equals"}], "jointType": "and"}, "type": "insert-or-merge-row", "mapping": [{"source": {"kind": "constant", "value": "{alterationType}"}, "factorId": "7e06ca2945f9405f86844a004c858009", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "{policyNum}"}, "factorId": "6f9803baae164b3bb77447652e1cfc52", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "{bill.billRefNo}"}, "factorId": "d9a0c783d822471f8a274384bbf66559", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "{dueDate}"}, "factorId": "94c66deb1fa54509ae5b78fe34a2e113", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "{appropriationDate}"}, "factorId": "cf508b7bcecc4c4dbd27409aa4356fcb", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "{appropriationType}"}, "factorId": "af3af4406aeb4604830e308d4ba6cea2", "arithmetic": "none"}, {"source": {"kind": "constant", "value": ""}, "factorId": "694dd72e481a43d3b88cfaadffe47708", "arithmetic": "none"}, {"source": {"kind": "constant", "value": ""}, "factorId": "99dc38414fb64ae6baa45a32bac00bc0", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "{collect.payMode}"}, "factorId": "a39e19560eec480b8728cd8c55d79351", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "0"}, "factorId": "da90f4e6f40848a5a2d43263473a8999", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "0"}, "factorId": "62d59d8d2153419e99e5a5e9ea26e3df", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "0"}, "factorId": "668f9230bdc243139424e7b89513875e", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "0"}, "factorId": "ed89770d8009494ebf4237c0e9f2344a", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "{bill.amount}"}, "factorId": "84ee4e96a88647c5b02d471a22691daf", "arithmetic": "none"}, {"source": {"kind": "constant", "value": ""}, "factorId": "f124f17bbbfa4cac92302029706c41a0", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "1"}, "factorId": "afccc2f006b249a7bc2197a134bebb8d", "arithmetic": "none"}, {"source": {"kind": "computed", "type": "case-then", "parameters": [{"on": {"filters": [{"left": {"kind": "constant", "value": "{bill.lifePolicyRenewalId}"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}], "jointType": "and"}, "kind": "constant", "value": "NA", "conditional": true}]}, "factorId": "49db592272ec45e5acdc403fcd52d427", "arithmetic": "none"}, {"source": {"kind": "topic", "topicId": "1009977843108600832", "factorId": "585cda8bfb72418585d6ebd26bb91b32"}, "factorId": "0e758aa778bd4a6692053be913ba3cf5", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "{transactionReferenceNumber}"}, "factorId": "e36532e27ae849bf82982b8841c068f6", "arithmetic": "none"}, {"source": {"kind": "topic", "topicId": "1009977843108600832", "factorId": "ef675e5b6adc45eda6a7b27f5e959deb"}, "factorId": "c6749c1bc0bc4f1bac387a5e031e01cd", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "{appropriationDate}"}, "factorId": "26f111d14ae643a6a06465691283a420", "arithmetic": "none"}, {"source": {"kind": "topic", "topicId": "1009977843108600832", "factorId": "c12304362cc34a21a90544c143e98223"}, "factorId": "6d9bc8325c25439098fdeac0d6bb1263", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "BIX"}, "factorId": "65dc4cc9c5654479836e7c72bbf34a42", "arithmetic": "none"}, {"source": {"kind": "topic", "topicId": "1009977843108600832", "factorId": "f1e05ea1ff21467e8ca56caa2b3f6ce5"}, "factorId": "fbfcda8fc96d489a90d8926462ceba3e", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "{installmentNo}"}, "factorId": "5ad6304fe2974c5a8475f4d2cd08173f", "arithmetic": "none"}], "message": "", "topicId": "1151162844587810816", "actionId": "1160619034997115913", "severity": "medium", "conditional": false}], "on": {"filters": [{"left": {"kind": "constant", "value": "{bill.billType}"}, "right": {"kind": "constant", "value": "DIRECT_PREM"}, "operator": "equals"}, {"left": {"kind": "topic", "topicId": "1009977843108600832", "factorId": "5b8f874bdffa4e54883c523232c2a159"}, "right": {"kind": "constant", "value": "true"}, "operator": "equals"}], "jointType": "and"}, "name": "data mapping", "unitId": "1160619034997115912", "conditional": true}], "stageId": "1160602852202073089", "conditional": false}]', enabled=1, validated=1, tenant_id='1013492659824011264', created_at='2023-10-08 07:41:22', created_by='1013492910945380352', last_modified_at='2024-03-13 10:01:05', last_modified_by='1013492910945380352', version=37
WHERE pipeline_id='1160602852202073088';

UPDATE pipelines
SET topic_id='1009983155375690752', name='Payment DMS Premium Mapping', `type`='insert-or-merge', prerequisite_enabled=1, prerequisite_on='{"filters": [{"left": {"kind": "topic", "topicId": "1009983155375690752", "factorId": "038a7d4ddcb84e97ac5d773b0ef97ce2"}, "right": {"kind": "constant", "value": "BILL_REFUND"}, "operator": "equals"}, {"left": {"kind": "topic", "topicId": "1009983155375690752", "factorId": "c973fb2f618e4b6a82911aa4f5cfcbb5"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}, {"left": {"kind": "topic", "topicId": "1009983155375690752", "factorId": "f2c4ef0084904924a3fcf47cebd92244"}, "right": {"kind": "constant", "value": "true"}, "operator": "equals"}], "jointType": "and"}', stages='[{"name": "load data", "units": [{"do": [{"by": {"filters": [{"left": {"kind": "topic", "topicId": "1009983155375690752", "factorId": "95bb78e2cea54ec498427b6f4d8da42d"}, "right": {"kind": "topic", "topicId": "1009982700352427008", "factorId": "517176eae57d428aaee7154be059023a"}, "operator": "equals"}], "jointType": "and"}, "type": "read-row", "message": "", "topicId": "1009982700352427008", "actionId": "1160628054415854595", "severity": "medium", "conditional": false, "variableName": "payment"}], "name": "load payment", "unitId": "1160628054415854594", "conditional": false}, {"do": [{"by": {"filters": [{"left": {"kind": "topic", "topicId": "1009983155375690752", "factorId": "c973fb2f618e4b6a82911aa4f5cfcbb5"}, "right": {"kind": "topic", "topicId": "1010301439824352256", "factorId": "a5a25793c4a24c8683fe2b00cd76bad5"}, "operator": "equals"}], "jointType": "and"}, "type": "read-row", "message": "", "topicId": "1010301439824352256", "actionId": "1160639433369668609", "severity": "medium", "conditional": false, "variableName": "bill"}], "name": "load bill", "unitId": "1160639433369668608", "conditional": false}, {"do": [{"by": {"filters": [{"left": {"kind": "topic", "topicId": "1141797703400318976", "factorId": "cc0ef369fcf94abc90146dba2f04355d"}, "right": {"kind": "constant", "value": "{bill.lifePolicyRenewalId}"}, "operator": "equals"}], "jointType": "and"}, "type": "read-row", "message": "", "topicId": "1141797703400318976", "actionId": "1210276386599097345", "severity": "medium", "conditional": false, "variableName": "lifePolicyRenewal"}], "on": {"filters": [{"left": {"kind": "constant", "value": "{bill.lifePolicyRenewalId}"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}], "jointType": "and"}, "name": "load lifePolicyRenewal", "unitId": "1210276386599097344", "conditional": true}], "stageId": "1160628054415854593", "conditional": false}, {"on": {"filters": [{"left": {"kind": "constant", "value": "{payment.status}"}, "right": {"kind": "constant", "value": "CONFIRMED,REVERSED"}, "operator": "in"}, {"left": {"kind": "constant", "value": "{bill.billType}"}, "right": {"kind": "constant", "value": "DIRECT_PREM"}, "operator": "equals"}], "jointType": "and"}, "name": "data mapping", "units": [{"do": [{"type": "copy-to-memory", "source": {"kind": "computed", "type": "case-then", "parameters": [{"on": {"filters": [{"left": {"kind": "constant", "value": "{payment.status}"}, "right": {"kind": "constant", "value": "REVERSED"}, "operator": "equals"}, {"left": {"kind": "topic", "topicId": "1009983155375690752", "factorId": "d8235e4a89524ab588c0d50002845a35"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}], "jointType": "and"}, "kind": "constant", "value": "FULLYPAIDREVERSAL", "conditional": true}, {"kind": "constant", "value": "FULLYPAID", "conditional": false}]}, "message": "", "actionId": "1160639433369668612", "severity": "medium", "conditional": false, "variableName": "alterationType"}, {"type": "copy-to-memory", "source": {"kind": "computed", "type": "case-then", "parameters": [{"on": {"filters": [{"left": {"kind": "constant", "value": "{payment.status}"}, "right": {"kind": "constant", "value": "REVERSED"}, "operator": "equals"}, {"left": {"kind": "topic", "topicId": "1009983155375690752", "factorId": "d8235e4a89524ab588c0d50002845a35"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}], "jointType": "and"}, "kind": "constant", "value": "{payment.createdAt}", "conditional": true}, {"kind": "constant", "value": "{payment.confirmedAt}", "conditional": false}]}, "message": "", "actionId": "1160639433369668613", "severity": "medium", "conditional": false, "variableName": "appropriationDate"}, {"type": "copy-to-memory", "source": {"kind": "computed", "type": "case-then", "parameters": [{"on": {"filters": [{"left": {"kind": "constant", "value": "{payment.status}"}, "right": {"kind": "constant", "value": "REVERSED"}, "operator": "equals"}, {"left": {"kind": "topic", "topicId": "1009983155375690752", "factorId": "d8235e4a89524ab588c0d50002845a35"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}], "jointType": "and"}, "kind": "constant", "value": "ACCRUAL", "conditional": true}, {"kind": "constant", "value": "PAID", "conditional": false}]}, "message": "", "actionId": "1160639433369668614", "severity": "medium", "conditional": false, "variableName": "appropriationType"}, {"type": "copy-to-memory", "source": {"kind": "computed", "type": "case-then", "parameters": [{"on": {"filters": [{"left": {"kind": "constant", "value": "{bill.ma_no}"}, "right": {"kind": "constant", "value": "{bill.ma_no}"}, "operator": "not-empty"}], "jointType": "and"}, "kind": "constant", "value": "{bill.ma_no}", "conditional": true}, {"kind": "constant", "value": "{bill.policy_no}", "conditional": false}]}, "message": "", "actionId": "1160639433369668615", "severity": "medium", "conditional": false, "variableName": "policyNum"}, {"type": "copy-to-memory", "source": {"kind": "computed", "type": "case-then", "parameters": [{"on": {"filters": [{"left": {"kind": "constant", "value": "{bill.bizType}"}, "right": {"kind": "constant", "value": "ENDO"}, "operator": "equals"}], "jointType": "and"}, "kind": "constant", "value": "ED{bill.endo_no}", "conditional": true}, {"on": {"filters": [{"left": {"kind": "constant", "value": "{bill.declaration_no}"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}], "jointType": "and"}, "kind": "constant", "value": "DL{bill.declaration_no}", "conditional": true}, {"kind": "constant", "value": "{bill.bizType}{policyNum}", "conditional": false}]}, "message": "", "actionId": "1160639433369668616", "severity": "medium", "conditional": false, "variableName": "transactionReferenceNumber"}], "name": "mapping value", "unitId": "1160639433369668611", "conditional": false}, {"do": [{"type": "copy-to-memory", "source": {"kind": "computed", "type": "case-then", "parameters": [{"on": {"filters": [{"left": {"kind": "constant", "value": "{bill.lifePolicyRenewalId}"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}], "jointType": "and"}, "kind": "constant", "value": "{lifePolicyRenewal.effDate}", "conditional": true}, {"kind": "constant", "value": "{bill.due_date}", "conditional": false}]}, "message": "", "actionId": "1210276386599097347", "severity": "medium", "conditional": false, "variableName": "dueDate"}], "name": "dueDate", "unitId": "1210276386599097346", "conditional": false}, {"do": [{"type": "copy-to-memory", "source": {"kind": "computed", "type": "case-then", "parameters": [{"on": {"filters": [{"left": {"kind": "constant", "value": "{bill.lifePolicyRenewalId}"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}], "jointType": "and"}, "kind": "constant", "value": "{lifePolicyRenewal.seq}", "conditional": true}, {"kind": "constant", "value": "{bill.billSeq}", "conditional": false}]}, "message": "", "actionId": "1210522366368044033", "severity": "medium", "conditional": false, "variableName": "installmentNo"}], "name": "installmentNo", "unitId": "1210522366368044032", "conditional": false}, {"do": [{"by": {"filters": [{"left": {"kind": "topic", "topicId": "1009983155375690752", "factorId": "af04fea9c7d840388e0dd9f99ecd2acc"}, "right": {"kind": "topic", "topicId": "1151162844587810816", "factorId": "6d9bc8325c25439098fdeac0d6bb1263"}, "operator": "equals"}], "jointType": "and"}, "type": "insert-or-merge-row", "mapping": [{"source": {"kind": "constant", "value": "{alterationType}"}, "factorId": "7e06ca2945f9405f86844a004c858009", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "{policyNum}"}, "factorId": "6f9803baae164b3bb77447652e1cfc52", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "{bill.billRefNo}"}, "factorId": "d9a0c783d822471f8a274384bbf66559", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "{dueDate}"}, "factorId": "94c66deb1fa54509ae5b78fe34a2e113", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "{appropriationDate}"}, "factorId": "cf508b7bcecc4c4dbd27409aa4356fcb", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "{appropriationType}"}, "factorId": "af3af4406aeb4604830e308d4ba6cea2", "arithmetic": "none"}, {"source": {"kind": "constant", "value": ""}, "factorId": "694dd72e481a43d3b88cfaadffe47708", "arithmetic": "none"}, {"source": {"kind": "constant", "value": ""}, "factorId": "99dc38414fb64ae6baa45a32bac00bc0", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "{payment.payMode}"}, "factorId": "a39e19560eec480b8728cd8c55d79351", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "0"}, "factorId": "da90f4e6f40848a5a2d43263473a8999", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "0"}, "factorId": "62d59d8d2153419e99e5a5e9ea26e3df", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "0"}, "factorId": "668f9230bdc243139424e7b89513875e", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "0"}, "factorId": "ed89770d8009494ebf4237c0e9f2344a", "arithmetic": "none"}, {"source": {"kind": "computed", "type": "multiply", "parameters": [{"kind": "constant", "value": "{bill.amount}"}, {"kind": "constant", "value": "{bill.drcr}"}]}, "factorId": "84ee4e96a88647c5b02d471a22691daf", "arithmetic": "none"}, {"source": {"kind": "constant", "value": ""}, "factorId": "f124f17bbbfa4cac92302029706c41a0", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "1"}, "factorId": "afccc2f006b249a7bc2197a134bebb8d", "arithmetic": "none"}, {"source": {"kind": "constant", "value": ""}, "factorId": "fbfcda8fc96d489a90d8926462ceba3e", "arithmetic": "none"}, {"source": {"kind": "computed", "type": "case-then", "parameters": [{"on": {"filters": [{"left": {"kind": "constant", "value": "{bill.lifePolicyRenewalId}"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}], "jointType": "and"}, "kind": "constant", "value": "NA", "conditional": true}]}, "factorId": "49db592272ec45e5acdc403fcd52d427", "arithmetic": "none"}, {"source": {"kind": "topic", "topicId": "1009983155375690752", "factorId": "4de1f1340bef41f9b687f50afeab5c9e"}, "factorId": "0e758aa778bd4a6692053be913ba3cf5", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "{transactionReferenceNumber}"}, "factorId": "e36532e27ae849bf82982b8841c068f6", "arithmetic": "none"}, {"source": {"kind": "topic", "topicId": "1009983155375690752", "factorId": "da7c03e930fc4c788bf288e536f755f1"}, "factorId": "c6749c1bc0bc4f1bac387a5e031e01cd", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "{appropriationDate}"}, "factorId": "26f111d14ae643a6a06465691283a420", "arithmetic": "none"}, {"source": {"kind": "topic", "topicId": "1009983155375690752", "factorId": "af04fea9c7d840388e0dd9f99ecd2acc"}, "factorId": "6d9bc8325c25439098fdeac0d6bb1263", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "BIX"}, "factorId": "65dc4cc9c5654479836e7c72bbf34a42", "arithmetic": "none"}, {"source": {"kind": "topic", "topicId": "1009983155375690752", "factorId": "6d3bf00d4f9745aa873478d42974009c"}, "factorId": "fbfcda8fc96d489a90d8926462ceba3e", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "{installmentNo}"}, "factorId": "5ad6304fe2974c5a8475f4d2cd08173f", "arithmetic": "none"}], "message": "", "topicId": "1151162844587810816", "actionId": "1160639433369668618", "severity": "medium", "conditional": false}], "on": {"filters": [{"left": {"kind": "topic", "topicId": "1009983155375690752", "factorId": "f9d4d75c31484160a72c47b85bccd0a6"}, "right": {"kind": "constant", "value": "true"}, "operator": "equals"}], "jointType": "and"}, "name": "data mapping", "unitId": "1160639433369668617", "conditional": true}], "stageId": "1160639433369668610", "conditional": true}]', enabled=1, validated=1, tenant_id='1013492659824011264', created_at='2023-10-08 09:21:31', created_by='1013492910945380352', last_modified_at='2024-03-13 10:01:26', last_modified_by='1013492910945380352', version=35
WHERE pipeline_id='1160628054415854592';

UPDATE pipelines
SET topic_id='1010300008295814144', name='Offset DMS Premium Mapping', `type`='insert-or-merge', prerequisite_enabled=1, prerequisite_on='{"filters": [{"left": {"kind": "topic", "topicId": "1010300008295814144", "factorId": "0d5b7bbcb8c6471097639c40fbcd6b3c"}, "right": {"kind": "constant", "value": "true"}, "operator": "equals"}], "jointType": "and"}', stages='[{"on": {"filters": [{"left": {"kind": "topic", "topicId": "1010300008295814144", "factorId": "e12012eb10fc4c5dbd75cb0573c0ff75"}, "right": {"kind": "constant", "value": "BAL_OFFSET_BILL,BILL_TO_BAL"}, "operator": "in"}], "jointType": "and"}, "name": "mapping bal offset", "units": [{"do": [{"by": {"filters": [{"left": {"kind": "topic", "topicId": "1010300008295814144", "factorId": "4649f7fdf2cf40c7bfb48892820e21e7"}, "right": {"kind": "topic", "topicId": "1010299517591606272", "factorId": "9a04b1ba48d3429db37ff51aa1915cb0"}, "operator": "equals"}], "jointType": "and"}, "type": "read-row", "source": {"kind": "computed", "type": "case-then", "parameters": [{"kind": "topic", "topicId": "", "factorId": "", "conditional": false}, {"kind": "topic", "topicId": "", "factorId": "", "conditional": false}]}, "message": "", "topicId": "1010299517591606272", "actionId": "1160639471122598915", "severity": "medium", "conditional": false, "variableName": "offset"}], "name": "load offset", "unitId": "1160639471122598914", "conditional": false}, {"do": [{"type": "copy-to-memory", "source": {"kind": "computed", "type": "case-then", "parameters": [{"on": {"filters": [{"left": {"kind": "topic", "topicId": "1010300008295814144", "factorId": "e12012eb10fc4c5dbd75cb0573c0ff75"}, "right": {"kind": "constant", "value": "BAL_OFFSET_BILL"}, "operator": "equals"}], "jointType": "and"}, "kind": "topic", "topicId": "1010300008295814144", "factorId": "6ccf9cfae68c4aae8d666c4db26f1ffe", "conditional": true}, {"kind": "topic", "topicId": "1010300008295814144", "factorId": "9aff0632b1d045548d8ba9a5ad55d1c4", "conditional": false}]}, "message": "", "actionId": "1160651036215430145", "severity": "medium", "conditional": false, "variableName": "billId"}, {"by": {"filters": [{"left": {"kind": "constant", "value": "{billId}"}, "right": {"kind": "topic", "topicId": "1010301439824352256", "factorId": "a5a25793c4a24c8683fe2b00cd76bad5"}, "operator": "equals"}], "jointType": "and"}, "type": "read-row", "message": "", "topicId": "1010301439824352256", "actionId": "1160651036215430146", "severity": "medium", "conditional": false, "variableName": "bill"}], "name": "load bill", "unitId": "1160651036215430144", "conditional": false}, {"do": [{"by": {"filters": [{"left": {"kind": "topic", "topicId": "1141797703400318976", "factorId": "cc0ef369fcf94abc90146dba2f04355d"}, "right": {"kind": "constant", "value": "{bill.lifePolicyRenewalId}"}, "operator": "equals"}], "jointType": "and"}, "type": "read-row", "message": "", "topicId": "1141797703400318976", "actionId": "1210293521849275393", "severity": "medium", "conditional": false, "variableName": "lifePolicyRenewal"}], "on": {"filters": [{"left": {"kind": "constant", "value": "{bill.lifePolicyRenewalId}"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}], "jointType": "and"}, "name": "load lifePolicyRenewal", "unitId": "1210293521849275392", "conditional": true}, {"do": [{"type": "copy-to-memory", "source": {"kind": "computed", "type": "case-then", "parameters": [{"on": {"filters": [{"left": {"kind": "topic", "topicId": "1010300008295814144", "factorId": "9aff0632b1d045548d8ba9a5ad55d1c4"}, "right": {"kind": "constant", "value": "REVERSED"}, "operator": "not-empty"}], "jointType": "and"}, "kind": "topic", "topicId": "1010300008295814144", "factorId": "e127a2130c66425cb7ba9dc422987f93", "conditional": true}, {"kind": "topic", "topicId": "1010300008295814144", "factorId": "d680419346054fff8b231f112c2e4091", "conditional": false}]}, "message": "", "actionId": "1160671437108759553", "severity": "medium", "conditional": false, "variableName": "needSync"}], "name": "needSync", "unitId": "1160671437108759552", "conditional": false}, {"do": [{"type": "copy-to-memory", "source": {"kind": "computed", "type": "case-then", "parameters": [{"on": {"filters": [{"left": {"kind": "constant", "value": "{offset.status}"}, "right": {"kind": "constant", "value": "REVERSED"}, "operator": "equals"}, {"left": {"kind": "topic", "topicId": "1010300008295814144", "factorId": "5e513463b2b942a08a1422734a310429"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}], "jointType": "and"}, "kind": "constant", "value": "FULLYPAIDREVERSAL", "conditional": true}, {"kind": "constant", "value": "FULLYPAID", "conditional": false}]}, "message": "", "actionId": "1160651036215430148", "severity": "medium", "conditional": false, "variableName": "alterationType"}, {"type": "copy-to-memory", "source": {"kind": "computed", "type": "case-then", "parameters": [{"on": {"filters": [{"left": {"kind": "constant", "value": "{offset.status}"}, "right": {"kind": "constant", "value": "REVERSED"}, "operator": "equals"}, {"left": {"kind": "topic", "topicId": "1010300008295814144", "factorId": "5e513463b2b942a08a1422734a310429"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}], "jointType": "and"}, "kind": "constant", "value": "{offset.createdAt}", "conditional": true}, {"kind": "constant", "value": "{offset.createdAt}", "conditional": false}]}, "message": "", "actionId": "1160651036215430149", "severity": "medium", "conditional": false, "variableName": "appropriationDate"}, {"type": "copy-to-memory", "source": {"kind": "computed", "type": "case-then", "parameters": [{"on": {"filters": [{"left": {"kind": "constant", "value": "{offset.status}"}, "right": {"kind": "constant", "value": "REVERSED"}, "operator": "equals"}, {"left": {"kind": "topic", "topicId": "1010300008295814144", "factorId": "5e513463b2b942a08a1422734a310429"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}], "jointType": "and"}, "kind": "constant", "value": "ACCRUAL", "conditional": true}, {"kind": "constant", "value": "PAID", "conditional": false}]}, "message": "", "actionId": "1160651036215430150", "severity": "medium", "conditional": false, "variableName": "appropriationType"}, {"type": "copy-to-memory", "source": {"kind": "computed", "type": "case-then", "parameters": [{"on": {"filters": [{"left": {"kind": "constant", "value": "{bill.ma_no}"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}], "jointType": "and"}, "kind": "constant", "value": "{bill.ma_no}", "conditional": true}, {"kind": "constant", "value": "{bill.policy_no}", "conditional": false}]}, "message": "", "actionId": "1160651036215430151", "severity": "medium", "conditional": false, "variableName": "policyNum"}, {"type": "copy-to-memory", "source": {"kind": "computed", "type": "case-then", "parameters": [{"on": {"filters": [{"left": {"kind": "constant", "value": "{bill.bizType}"}, "right": {"kind": "constant", "value": "ENDO"}, "operator": "equals"}], "jointType": "and"}, "kind": "constant", "value": "ED{bill.endo_no}", "conditional": true}, {"on": {"filters": [{"left": {"kind": "constant", "value": "{bill.declaration_no}"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}], "jointType": "and"}, "kind": "constant", "value": "DL{bill.declaration_no}", "conditional": true}, {"kind": "constant", "value": "{bill.bizType}{policyNum}", "conditional": false}]}, "message": "", "actionId": "1160671437108759554", "severity": "medium", "conditional": false, "variableName": "transactionReferenceNumber"}], "name": "mapping value", "unitId": "1160651036215430147", "conditional": false}, {"do": [{"type": "copy-to-memory", "source": {"kind": "computed", "type": "case-then", "parameters": [{"on": {"filters": [{"left": {"kind": "constant", "value": "{bill.lifePolicyRenewalId}"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}], "jointType": "and"}, "kind": "constant", "value": "{lifePolicyRenewal.effDate}", "conditional": true}, {"kind": "constant", "value": "{bill.due_date}", "conditional": false}]}, "message": "", "actionId": "1210293521849275395", "severity": "medium", "conditional": false, "variableName": "dueDate"}], "name": "dueDate", "unitId": "1210293521849275394", "conditional": false}, {"do": [{"type": "copy-to-memory", "source": {"kind": "computed", "type": "case-then", "parameters": [{"on": {"filters": [{"left": {"kind": "constant", "value": "{bill.lifePolicyRenewalId}"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}], "jointType": "and"}, "kind": "constant", "value": "{lifePolicyRenewal.seq}", "conditional": true}, {"kind": "constant", "value": "{bill.billSeq}", "conditional": false}]}, "message": "", "actionId": "1210523479699903489", "severity": "medium", "conditional": false, "variableName": "installmentNo"}], "name": "installmentNo", "unitId": "1210523479699903488", "conditional": false}, {"do": [{"by": {"filters": [{"left": {"kind": "topic", "topicId": "1010300008295814144", "factorId": "63dd8abd3cac446d9f01d4de66cae1c9"}, "right": {"kind": "topic", "topicId": "1151162844587810816", "factorId": "6d9bc8325c25439098fdeac0d6bb1263"}, "operator": "equals"}], "jointType": "and"}, "type": "insert-or-merge-row", "mapping": [{"source": {"kind": "constant", "value": "{alterationType}"}, "factorId": "7e06ca2945f9405f86844a004c858009", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "{policyNum}"}, "factorId": "6f9803baae164b3bb77447652e1cfc52", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "{bill.billRefNo}"}, "factorId": "d9a0c783d822471f8a274384bbf66559", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "{dueDate}"}, "factorId": "94c66deb1fa54509ae5b78fe34a2e113", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "{appropriationDate}"}, "factorId": "cf508b7bcecc4c4dbd27409aa4356fcb", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "{appropriationType}"}, "factorId": "af3af4406aeb4604830e308d4ba6cea2", "arithmetic": "none"}, {"source": {"kind": "constant", "value": ""}, "factorId": "694dd72e481a43d3b88cfaadffe47708", "arithmetic": "none"}, {"source": {"kind": "constant", "value": ""}, "factorId": "99dc38414fb64ae6baa45a32bac00bc0", "arithmetic": "none"}, {"source": {"kind": "constant", "value": ""}, "factorId": "a39e19560eec480b8728cd8c55d79351", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "0"}, "factorId": "da90f4e6f40848a5a2d43263473a8999", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "0"}, "factorId": "62d59d8d2153419e99e5a5e9ea26e3df", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "0"}, "factorId": "668f9230bdc243139424e7b89513875e", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "0"}, "factorId": "ed89770d8009494ebf4237c0e9f2344a", "arithmetic": "none"}, {"source": {"kind": "computed", "type": "multiply", "parameters": [{"kind": "constant", "value": "{bill.amount}"}, {"kind": "constant", "value": "{bill.drcr}"}]}, "factorId": "84ee4e96a88647c5b02d471a22691daf", "arithmetic": "none"}, {"source": {"kind": "constant", "value": ""}, "factorId": "f124f17bbbfa4cac92302029706c41a0", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "1"}, "factorId": "afccc2f006b249a7bc2197a134bebb8d", "arithmetic": "none"}, {"source": {"kind": "constant", "value": ""}, "factorId": "fbfcda8fc96d489a90d8926462ceba3e", "arithmetic": "none"}, {"source": {"kind": "computed", "type": "case-then", "parameters": [{"on": {"filters": [{"left": {"kind": "constant", "value": "{bill.lifePolicyRenewalId}"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}], "jointType": "and"}, "kind": "constant", "value": "NA", "conditional": true}]}, "factorId": "49db592272ec45e5acdc403fcd52d427", "arithmetic": "none"}, {"source": {"kind": "constant", "value": ""}, "factorId": "0e758aa778bd4a6692053be913ba3cf5", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "{transactionReferenceNumber}"}, "factorId": "e36532e27ae849bf82982b8841c068f6", "arithmetic": "none"}, {"source": {"kind": "computed", "type": "case-then", "parameters": [{"on": {"filters": [{"left": {"kind": "topic", "topicId": "1010300008295814144", "factorId": "9aff0632b1d045548d8ba9a5ad55d1c4"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}], "jointType": "and"}, "kind": "topic", "topicId": "1010300008295814144", "factorId": "cad409eb603c4ab08d63657655149754", "conditional": true}, {"on": {"filters": [{"left": {"kind": "topic", "topicId": "1010300008295814144", "factorId": "6ccf9cfae68c4aae8d666c4db26f1ffe"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}], "jointType": "and"}, "kind": "topic", "topicId": "1010300008295814144", "factorId": "dfa03510a4424cbdbe503d6f113948e1", "conditional": true}, {"kind": "constant", "value": "", "conditional": false}]}, "factorId": "c6749c1bc0bc4f1bac387a5e031e01cd", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "{appropriationDate}"}, "factorId": "26f111d14ae643a6a06465691283a420", "arithmetic": "none"}, {"source": {"kind": "topic", "topicId": "1010300008295814144", "factorId": "63dd8abd3cac446d9f01d4de66cae1c9"}, "factorId": "6d9bc8325c25439098fdeac0d6bb1263", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "BIX"}, "factorId": "65dc4cc9c5654479836e7c72bbf34a42", "arithmetic": "none"}, {"source": {"kind": "topic", "topicId": "1010300008295814144", "factorId": "3202ca669cc24261a68951e412154e9f"}, "factorId": "fbfcda8fc96d489a90d8926462ceba3e", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "{installmentNo}"}, "factorId": "5ad6304fe2974c5a8475f4d2cd08173f", "arithmetic": "none"}], "message": "", "topicId": "1151162844587810816", "actionId": "1160671437108759556", "severity": "medium", "conditional": false}], "on": {"filters": [{"left": {"kind": "constant", "value": "{bill.billType}"}, "right": {"kind": "constant", "value": "DIRECT_PREM"}, "operator": "equals"}, {"left": {"kind": "constant", "value": "{needSync}"}, "right": {"kind": "constant", "value": "true"}, "operator": "equals"}], "jointType": "and"}, "name": "data mapping", "unitId": "1160671437108759555", "conditional": true}], "stageId": "1160639471122598913", "conditional": true}, {"on": {"filters": [{"left": {"kind": "topic", "topicId": "1010300008295814144", "factorId": "e12012eb10fc4c5dbd75cb0573c0ff75"}, "right": {"kind": "constant", "value": "BILL_OFFSET_BILL"}, "operator": "equals"}, {"left": {"kind": "topic", "topicId": "1010300008295814144", "factorId": "9aff0632b1d045548d8ba9a5ad55d1c4"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}, {"left": {"kind": "topic", "topicId": "1010300008295814144", "factorId": "6ccf9cfae68c4aae8d666c4db26f1ffe"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}], "jointType": "and"}, "name": "mapping bill offset bill", "units": [{"do": [{"by": {"filters": [{"left": {"kind": "topic", "topicId": "1010300008295814144", "factorId": "4649f7fdf2cf40c7bfb48892820e21e7"}, "right": {"kind": "topic", "topicId": "1010299517591606272", "factorId": "9a04b1ba48d3429db37ff51aa1915cb0"}, "operator": "equals"}], "jointType": "and"}, "type": "read-row", "message": "", "topicId": "1010299517591606272", "actionId": "1160671437108759559", "severity": "medium", "conditional": false, "variableName": "offset"}], "name": "load offset data", "unitId": "1160671437108759558", "conditional": false, "loopVariableName": ""}, {"do": [{"by": {"filters": [{"left": {"kind": "topic", "topicId": "1010300008295814144", "factorId": "9aff0632b1d045548d8ba9a5ad55d1c4"}, "right": {"kind": "topic", "topicId": "1010301439824352256", "factorId": "a5a25793c4a24c8683fe2b00cd76bad5"}, "operator": "equals"}], "jointType": "and"}, "type": "read-row", "message": "", "topicId": "1010301439824352256", "actionId": "1160671437108759561", "severity": "medium", "conditional": false, "variableName": "fromBill"}], "name": "load from bill", "unitId": "1160671437108759560", "conditional": false}, {"do": [{"by": {"filters": [{"left": {"kind": "topic", "topicId": "1141797703400318976", "factorId": "cc0ef369fcf94abc90146dba2f04355d"}, "right": {"kind": "constant", "value": "{fromBill.lifePolicyRenewalId}"}, "operator": "equals"}], "jointType": "and"}, "type": "read-row", "message": "", "topicId": "1141797703400318976", "actionId": "1210293521849275397", "severity": "medium", "conditional": false, "variableName": "fromLifePolicyRenewal"}], "on": {"filters": [{"left": {"kind": "constant", "value": "{fromBill.lifePolicyRenewalId}"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}], "jointType": "and"}, "name": "load fromLifePolicyRenewal", "unitId": "1210293521849275396", "conditional": true}, {"do": [{"by": {"filters": [{"left": {"kind": "topic", "topicId": "1010300008295814144", "factorId": "6ccf9cfae68c4aae8d666c4db26f1ffe"}, "right": {"kind": "topic", "topicId": "1010301439824352256", "factorId": "a5a25793c4a24c8683fe2b00cd76bad5"}, "operator": "equals"}], "jointType": "and"}, "type": "read-row", "source": {"kind": "constant", "value": ""}, "message": "", "topicId": "1010301439824352256", "actionId": "1160671437108759563", "severity": "medium", "conditional": false, "variableName": "toBill"}], "name": "load to bill", "unitId": "1160671437108759562", "conditional": false}, {"do": [{"by": {"filters": [{"left": {"kind": "topic", "topicId": "1141797703400318976", "factorId": "cc0ef369fcf94abc90146dba2f04355d"}, "right": {"kind": "constant", "value": "{toBill.lifePolicyRenewalId}"}, "operator": "equals"}], "jointType": "and"}, "type": "read-row", "source": {"kind": "constant", "value": ""}, "message": "", "topicId": "1141797703400318976", "actionId": "1210293521849275399", "severity": "medium", "conditional": false, "variableName": "toLifePolicyRenewal"}], "on": {"filters": [{"left": {"kind": "constant", "value": "{toBill.lifePolicyRenewalId}"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}], "jointType": "and"}, "name": "load toLifePolicyRenewal", "unitId": "1210293521849275398", "conditional": true}, {"do": [{"type": "copy-to-memory", "source": {"kind": "topic", "topicId": "1010300008295814144", "factorId": "63dd8abd3cac446d9f01d4de66cae1c9"}, "message": "", "actionId": "1160897157479222273", "severity": "medium", "conditional": false, "variableName": "itemId"}], "name": "item info", "unitId": "1160897157479222272", "conditional": false}], "stageId": "1160671437108759557", "conditional": true}, {"on": {"filters": [{"left": {"kind": "constant", "value": "{offset.status}"}, "right": {"kind": "constant", "value": "VALID,REVERSED"}, "operator": "in"}, {"left": {"kind": "topic", "topicId": "1010300008295814144", "factorId": "e12012eb10fc4c5dbd75cb0573c0ff75"}, "right": {"kind": "constant", "value": "BILL_OFFSET_BILL"}, "operator": "equals"}, {"left": {"kind": "topic", "topicId": "1010300008295814144", "factorId": "9aff0632b1d045548d8ba9a5ad55d1c4"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}, {"left": {"kind": "constant", "value": "{fromBill.billType}"}, "right": {"kind": "constant", "value": "DIRECT_PREM,DIRECT_COMM"}, "operator": "in"}], "jointType": "and"}, "name": "mapping from bill", "units": [{"do": [{"type": "copy-to-memory", "source": {"kind": "computed", "type": "case-then", "parameters": [{"on": {"filters": [{"left": {"kind": "constant", "value": "{fromBill.billType}"}, "right": {"kind": "constant", "value": "DIRECT_PREM"}, "operator": "equals"}], "jointType": "and"}, "kind": "computed", "type": "case-then", "parameters": [{"on": {"filters": [{"left": {"kind": "constant", "value": "{offset.status}"}, "right": {"kind": "constant", "value": "REVERSED"}, "operator": "equals"}, {"left": {"kind": "topic", "topicId": "1010300008295814144", "factorId": "5e513463b2b942a08a1422734a310429"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}], "jointType": "and"}, "kind": "constant", "value": "FULLYPAIDREVERSAL", "conditional": true}, {"kind": "constant", "value": "FULLYPAID", "conditional": false}], "conditional": true}, {"kind": "computed", "type": "case-then", "parameters": [{"on": {"filters": [{"left": {"kind": "constant", "value": "{offset.status}"}, "right": {"kind": "constant", "value": "REVERSED"}, "operator": "equals"}, {"left": {"kind": "topic", "topicId": "1010300008295814144", "factorId": "5e513463b2b942a08a1422734a310429"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}], "jointType": "and"}, "kind": "constant", "value": "COMMISSIONOFFSETREVERSAL", "conditional": true}, {"kind": "constant", "value": "COMMISSIONOFFSET", "conditional": false}], "conditional": false}]}, "message": "", "actionId": "1160671437108759566", "severity": "medium", "conditional": false, "variableName": "fromAlterationType"}], "name": "FromAlterationType", "unitId": "1160671437108759565", "conditional": false}, {"do": [{"type": "copy-to-memory", "source": {"kind": "constant", "value": "{offset.createdAt}"}, "message": "", "actionId": "1160877264386083841", "severity": "medium", "conditional": false, "variableName": "fromAppropriationDate"}], "name": "From AppropriationDate", "unitId": "1160877264386083840", "conditional": false}, {"do": [{"type": "copy-to-memory", "source": {"kind": "computed", "type": "case-then", "parameters": [{"on": {"filters": [{"left": {"kind": "constant", "value": "{offset.status}"}, "right": {"kind": "constant", "value": "REVERSED"}, "operator": "equals"}, {"left": {"kind": "topic", "topicId": "1010300008295814144", "factorId": "5e513463b2b942a08a1422734a310429"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}], "jointType": "and"}, "kind": "constant", "value": "ACCRUAL", "conditional": true}, {"kind": "constant", "value": "PAID", "conditional": false}]}, "message": "", "actionId": "1160877264386083843", "severity": "medium", "conditional": false, "variableName": "fromAppropriationType"}], "name": "From AppropriationType", "unitId": "1160877264386083842", "conditional": false}, {"do": [{"type": "copy-to-memory", "source": {"kind": "computed", "type": "case-then", "parameters": [{"on": {"filters": [{"left": {"kind": "constant", "value": "{fromBill.ma_no}"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}], "jointType": "and"}, "kind": "constant", "value": "{fromBill.ma_no}", "conditional": true}, {"kind": "constant", "value": "{fromBill.policy_no}", "conditional": false}]}, "message": "", "actionId": "1160671437108759568", "severity": "medium", "conditional": false, "variableName": "fromPolicyNum"}], "name": "From policyNum", "unitId": "1160671437108759567", "conditional": false}, {"do": [{"type": "copy-to-memory", "source": {"kind": "computed", "type": "case-then", "parameters": [{"on": {"filters": [{"left": {"kind": "constant", "value": "{fromBill.bizType}"}, "right": {"kind": "constant", "value": "ENDO"}, "operator": "equals"}], "jointType": "and"}, "kind": "constant", "value": "ED{fromBill.endo_no}", "conditional": true}, {"on": {"filters": [{"left": {"kind": "constant", "value": "{fromBill.declaration_no}"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}], "jointType": "and"}, "kind": "constant", "value": "DL{fromBill.declaration_no}", "conditional": true}, {"kind": "constant", "value": "{fromBill.bizType}{fromPolicyNum}", "conditional": false}]}, "message": "", "actionId": "1160897157479222275", "severity": "medium", "conditional": false, "variableName": "fromTransactionReferenceNumber"}], "name": "from TransactionReferenceNumber", "unitId": "1160897157479222274", "conditional": false}, {"do": [{"type": "copy-to-memory", "source": {"kind": "constant", "value": "{itemId}{fromBill.billRefNo}"}, "message": "", "actionId": "1164155887284649985", "severity": "medium", "conditional": false, "variableName": "formRefId"}], "name": "formRefId", "unitId": "1164155887284649984", "conditional": false}, {"do": [{"type": "copy-to-memory", "source": {"kind": "computed", "type": "case-then", "parameters": [{"on": {"filters": [{"left": {"kind": "constant", "value": "{toBill.billType}"}, "right": {"kind": "constant", "value": "DIRECT_COMM"}, "operator": "equals"}], "jointType": "and"}, "kind": "constant", "value": "true", "conditional": true}, {"kind": "constant", "value": "false", "conditional": false}]}, "message": "", "actionId": "1171406604366454785", "severity": "medium", "conditional": false, "variableName": "isToBillWasDirectComm"}], "name": " is ToBill Was Direct Comm", "unitId": "1171406604366454784", "conditional": false}, {"do": [{"type": "copy-to-memory", "source": {"kind": "computed", "type": "case-then", "parameters": [{"on": {"filters": [{"left": {"kind": "constant", "value": "{fromBill.billType}"}, "right": {"kind": "constant", "value": "DIRECT_PREM"}, "operator": "equals"}], "jointType": "and"}, "kind": "topic", "topicId": "1010300008295814144", "factorId": "3202ca669cc24261a68951e412154e9f", "conditional": true}, {"kind": "constant", "value": "", "conditional": false}]}, "message": "", "actionId": "1186719231695019009", "severity": "medium", "conditional": false, "variableName": "fromCommDNCNRefNo"}], "name": "mapping fromCommDNCNRefNo", "unitId": "1186719231695019008", "conditional": false}, {"do": [{"type": "copy-to-memory", "source": {"kind": "computed", "type": "case-then", "parameters": [{"on": {"filters": [{"left": {"kind": "constant", "value": "{fromBill.lifePolicyRenewalId}"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}], "jointType": "and"}, "kind": "constant", "value": "{fromLifePolicyRenewal.effDate}", "conditional": true}, {"kind": "constant", "value": "{fromBill.due_date}", "conditional": false}]}, "message": "", "actionId": "1210293521849275401", "severity": "medium", "conditional": false, "variableName": "fromDueDate"}], "name": "fromDueDate", "unitId": "1210293521849275400", "conditional": false}, {"do": [{"type": "copy-to-memory", "source": {"kind": "computed", "type": "case-then", "parameters": [{"on": {"filters": [{"left": {"kind": "constant", "value": "{fromBill.lifePolicyRenewalId}"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}], "jointType": "and"}, "kind": "constant", "value": "{fromLifePolicyRenewal.seq}", "conditional": true}, {"kind": "constant", "value": "{fromBill.billSeq}", "conditional": false}]}, "message": "", "actionId": "1210523479699903491", "severity": "medium", "conditional": false, "variableName": "fromInstallmentNo"}], "name": "fromInstallmentNo", "unitId": "1210523479699903490", "conditional": false}, {"do": [{"by": {"filters": [{"left": {"kind": "constant", "value": "{formRefId}"}, "right": {"kind": "topic", "topicId": "1151162844587810816", "factorId": "6d9bc8325c25439098fdeac0d6bb1263"}, "operator": "equals"}], "jointType": "and"}, "type": "insert-or-merge-row", "mapping": [{"source": {"kind": "constant", "value": "{fromAlterationType}"}, "factorId": "7e06ca2945f9405f86844a004c858009", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "{fromPolicyNum}"}, "factorId": "6f9803baae164b3bb77447652e1cfc52", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "{fromBill.billRefNo}"}, "factorId": "d9a0c783d822471f8a274384bbf66559", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "{fromDueDate}"}, "factorId": "94c66deb1fa54509ae5b78fe34a2e113", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "{fromAppropriationDate}"}, "factorId": "cf508b7bcecc4c4dbd27409aa4356fcb", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "{fromAppropriationType}"}, "factorId": "af3af4406aeb4604830e308d4ba6cea2", "arithmetic": "none"}, {"source": {"kind": "constant", "value": ""}, "factorId": "694dd72e481a43d3b88cfaadffe47708", "arithmetic": "none"}, {"source": {"kind": "constant", "value": ""}, "factorId": "99dc38414fb64ae6baa45a32bac00bc0", "arithmetic": "none"}, {"source": {"kind": "constant", "value": ""}, "factorId": "a39e19560eec480b8728cd8c55d79351", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "0"}, "factorId": "da90f4e6f40848a5a2d43263473a8999", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "0"}, "factorId": "62d59d8d2153419e99e5a5e9ea26e3df", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "0"}, "factorId": "668f9230bdc243139424e7b89513875e", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "0"}, "factorId": "ed89770d8009494ebf4237c0e9f2344a", "arithmetic": "none"}, {"source": {"kind": "computed", "type": "multiply", "parameters": [{"kind": "constant", "value": "{fromBill.amount}"}, {"kind": "constant", "value": "{fromBill.drcr}"}]}, "factorId": "84ee4e96a88647c5b02d471a22691daf", "arithmetic": "none"}, {"source": {"kind": "constant", "value": ""}, "factorId": "f124f17bbbfa4cac92302029706c41a0", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "1"}, "factorId": "afccc2f006b249a7bc2197a134bebb8d", "arithmetic": "none"}, {"source": {"kind": "constant", "value": ""}, "factorId": "fbfcda8fc96d489a90d8926462ceba3e", "arithmetic": "none"}, {"source": {"kind": "computed", "type": "case-then", "parameters": [{"on": {"filters": [{"left": {"kind": "constant", "value": "{fromBill.lifePolicyRenewalId}"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}], "jointType": "and"}, "kind": "constant", "value": "NA", "conditional": true}]}, "factorId": "49db592272ec45e5acdc403fcd52d427", "arithmetic": "none"}, {"source": {"kind": "constant", "value": ""}, "factorId": "0e758aa778bd4a6692053be913ba3cf5", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "{fromTransactionReferenceNumber}"}, "factorId": "e36532e27ae849bf82982b8841c068f6", "arithmetic": "none"}, {"source": {"kind": "topic", "topicId": "1010300008295814144", "factorId": "cad409eb603c4ab08d63657655149754"}, "factorId": "c6749c1bc0bc4f1bac387a5e031e01cd", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "{fromAppropriationDate}"}, "factorId": "26f111d14ae643a6a06465691283a420", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "{formRefId}"}, "factorId": "6d9bc8325c25439098fdeac0d6bb1263", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "BIX"}, "factorId": "65dc4cc9c5654479836e7c72bbf34a42", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "{fromCommDNCNRefNo}"}, "factorId": "fbfcda8fc96d489a90d8926462ceba3e", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "{fromInstallmentNo}"}, "factorId": "5ad6304fe2974c5a8475f4d2cd08173f", "arithmetic": "none"}], "message": "", "topicId": "1151162844587810816", "actionId": "1160897157479222277", "severity": "medium", "conditional": false}], "on": {"filters": [{"left": {"kind": "topic", "topicId": "1010300008295814144", "factorId": "e127a2130c66425cb7ba9dc422987f93"}, "right": {"kind": "constant", "value": "true"}, "operator": "equals"}, {"left": {"kind": "constant", "value": "{isToBillWasDirectComm}"}, "right": {"kind": "constant", "value": "false"}, "operator": "equals"}], "jointType": "and"}, "name": "data mapping", "unitId": "1160897157479222276", "conditional": true}], "stageId": "1160671437108759564", "conditional": true}, {"on": {"filters": [{"left": {"kind": "constant", "value": "{offset.status}"}, "right": {"kind": "constant", "value": "VALID,REVERSED"}, "operator": "in"}, {"left": {"kind": "topic", "topicId": "1010300008295814144", "factorId": "e12012eb10fc4c5dbd75cb0573c0ff75"}, "right": {"kind": "constant", "value": "BILL_OFFSET_BILL"}, "operator": "equals"}, {"left": {"kind": "topic", "topicId": "1010300008295814144", "factorId": "6ccf9cfae68c4aae8d666c4db26f1ffe"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}, {"left": {"kind": "constant", "value": "{toBill.billType}"}, "right": {"kind": "constant", "value": "DIRECT_PREM,DIRECT_COMM"}, "operator": "in"}], "jointType": "and"}, "name": "mapping to bill", "units": [{"do": [{"type": "copy-to-memory", "source": {"kind": "computed", "type": "case-then", "parameters": [{"on": {"filters": [{"left": {"kind": "constant", "value": "{toBill.billType}"}, "right": {"kind": "constant", "value": "DIRECT_PREM"}, "operator": "equals"}], "jointType": "and"}, "kind": "computed", "type": "case-then", "parameters": [{"on": {"filters": [{"left": {"kind": "constant", "value": "{offset.status}"}, "right": {"kind": "constant", "value": "REVERSED"}, "operator": "equals"}, {"left": {"kind": "topic", "topicId": "1010300008295814144", "factorId": "5e513463b2b942a08a1422734a310429"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}], "jointType": "and"}, "kind": "constant", "value": "FULLYPAIDREVERSAL", "conditional": true}, {"kind": "constant", "value": "FULLYPAID", "conditional": false}], "conditional": true}, {"kind": "computed", "type": "case-then", "parameters": [{"on": {"filters": [{"left": {"kind": "constant", "value": "{offset.status}"}, "right": {"kind": "constant", "value": "REVERSED"}, "operator": "equals"}, {"left": {"kind": "topic", "topicId": "1010300008295814144", "factorId": "5e513463b2b942a08a1422734a310429"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}], "jointType": "and"}, "kind": "constant", "value": "COMMISSIONOFFSETREVERSAL", "conditional": true}, {"kind": "constant", "value": "COMMISSIONOFFSET", "conditional": false}], "conditional": false}]}, "message": "", "actionId": "1160897157479222280", "severity": "medium", "conditional": false, "variableName": "toAlterationType"}], "name": "ToAlterationType", "unitId": "1160897157479222279", "conditional": false}, {"do": [{"type": "copy-to-memory", "source": {"kind": "constant", "value": "{offset.createdAt}"}, "message": "", "actionId": "1160897157479222282", "severity": "medium", "conditional": false, "variableName": "toAppropriationDate"}], "name": "To AppropriationDate", "unitId": "1160897157479222281", "conditional": false}, {"do": [{"type": "copy-to-memory", "source": {"kind": "computed", "type": "case-then", "parameters": [{"on": {"filters": [{"left": {"kind": "constant", "value": "{offset.status}"}, "right": {"kind": "constant", "value": "REVERSED"}, "operator": "equals"}, {"left": {"kind": "topic", "topicId": "1010300008295814144", "factorId": "5e513463b2b942a08a1422734a310429"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}], "jointType": "and"}, "kind": "constant", "value": "ACCRUAL", "conditional": true}, {"kind": "constant", "value": "PAID", "conditional": false}]}, "message": "", "actionId": "1160897157479222284", "severity": "medium", "conditional": false, "variableName": "toAppropriationType"}], "name": "To AppropriationType", "unitId": "1160897157479222283", "conditional": false}, {"do": [{"type": "copy-to-memory", "source": {"kind": "computed", "type": "case-then", "parameters": [{"on": {"filters": [{"left": {"kind": "constant", "value": "{toBill.ma_no}"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}], "jointType": "and"}, "kind": "constant", "value": "{toBill.ma_no}", "conditional": true}, {"kind": "constant", "value": "{toBill.policy_no}", "conditional": false}]}, "message": "", "actionId": "1160897157479222286", "severity": "medium", "conditional": false, "variableName": "toPolicyNum"}], "name": "To PolicyNum", "unitId": "1160897157479222285", "conditional": false}, {"do": [{"type": "copy-to-memory", "source": {"kind": "computed", "type": "case-then", "parameters": [{"on": {"filters": [{"left": {"kind": "constant", "value": "{toBill.bizType}"}, "right": {"kind": "constant", "value": "ENDO"}, "operator": "equals"}], "jointType": "and"}, "kind": "constant", "value": "ED{toBill.endo_no}", "conditional": true}, {"on": {"filters": [{"left": {"kind": "constant", "value": "{toBill.declaration_no}"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}], "jointType": "and"}, "kind": "constant", "value": "DL{toBill.declaration_no}", "conditional": true}, {"kind": "constant", "value": "{toBill.bizType}{toPolicyNum}", "conditional": false}]}, "message": "", "actionId": "1160897157479222288", "severity": "medium", "conditional": false, "variableName": "toTransactionReferenceNumber"}], "name": "To TransactionReferenceNumber", "unitId": "1160897157479222287", "conditional": false}, {"do": [{"type": "copy-to-memory", "source": {"kind": "computed", "type": "case-then", "parameters": [{"on": {"filters": [{"left": {"kind": "constant", "value": "{toBill.billType}"}, "right": {"kind": "constant", "value": "DIRECT_COMM"}, "operator": "equals"}], "jointType": "and"}, "kind": "computed", "type": "multiply", "parameters": [{"kind": "constant", "value": "{toBill.originalFeeAmount}"}, {"kind": "constant", "value": "{toBill.drcr}"}], "conditional": true}, {"kind": "constant", "value": "0", "conditional": false}]}, "message": "", "actionId": "1160897157479222290", "severity": "medium", "conditional": false, "variableName": "ANP"}, {"type": "copy-to-memory", "source": {"kind": "computed", "type": "case-then", "parameters": [{"on": {"filters": [{"left": {"kind": "constant", "value": "{toBill.billType}"}, "right": {"kind": "constant", "value": "DIRECT_COMM"}, "operator": "equals"}], "jointType": "and"}, "kind": "computed", "type": "multiply", "parameters": [{"kind": "constant", "value": "{toBill.amount}"}, {"kind": "constant", "value": "{toBill.drcr}"}], "conditional": true}, {"kind": "constant", "value": "0", "conditional": false}]}, "message": "", "actionId": "1160897157479222291", "severity": "medium", "conditional": false, "variableName": "APP"}, {"type": "copy-to-memory", "source": {"kind": "computed", "type": "case-then", "parameters": [{"on": {"filters": [{"left": {"kind": "constant", "value": "{toBill.billType}"}, "right": {"kind": "constant", "value": "DIRECT_COMM"}, "operator": "equals"}], "jointType": "and"}, "kind": "constant", "value": "{toBill.billRefNo}", "conditional": true}, {"kind": "constant", "value": "", "conditional": false}]}, "message": "", "actionId": "1160897157479222292", "severity": "medium", "conditional": false, "variableName": "comissionRef"}], "name": "mapping comission", "unitId": "1160897157479222289", "conditional": false}, {"do": [{"type": "copy-to-memory", "source": {"kind": "computed", "type": "case-then", "parameters": [{"on": {"filters": [{"left": {"kind": "constant", "value": "{toBill.billType}"}, "right": {"kind": "constant", "value": "DIRECT_COMM"}, "operator": "equals"}], "jointType": "and"}, "kind": "constant", "value": "{APP}", "conditional": true}, {"kind": "computed", "type": "multiply", "parameters": [{"kind": "constant", "value": "{toBill.amount}"}, {"kind": "constant", "value": "{toBill.drcr}"}], "conditional": false}]}, "message": "", "actionId": "1160897157479222294", "severity": "medium", "conditional": false, "variableName": "toAppropriationAmount"}], "name": "to AppropriationAmount", "unitId": "1160897157479222293", "conditional": false}, {"do": [{"type": "copy-to-memory", "source": {"kind": "computed", "type": "case-then", "parameters": [{"on": {"filters": [{"left": {"kind": "constant", "value": "{toBill.billType}"}, "right": {"kind": "constant", "value": "DIRECT_COMM"}, "operator": "equals"}], "jointType": "and"}, "kind": "constant", "value": "{fromBill.billRefNo}", "conditional": true}, {"kind": "constant", "value": "{toBill.billRefNo}", "conditional": false}]}, "message": "", "actionId": "1160897157479222296", "severity": "medium", "conditional": false, "variableName": "billReNum"}], "name": "Ref Num", "unitId": "1160897157479222295", "conditional": false}, {"do": [{"on": {"filters": [{"left": {"kind": "topic", "topicId": "", "factorId": ""}, "right": {"kind": "constant", "value": ""}, "operator": "equals"}], "jointType": "and"}, "type": "copy-to-memory", "source": {"kind": "constant", "value": "{itemId}{toBill.billRefNo}"}, "message": "", "actionId": "1164155887284649987", "severity": "medium", "conditional": true, "variableName": "toBillRefId"}], "name": "toBillRefId", "unitId": "1164155887284649986", "conditional": false}, {"do": [{"type": "copy-to-memory", "source": {"kind": "computed", "type": "case-then", "parameters": [{"on": {"filters": [{"left": {"kind": "constant", "value": "{fromBill.billType}"}, "right": {"kind": "constant", "value": "DIRECT_COMM"}, "operator": "equals"}], "jointType": "and"}, "kind": "constant", "value": "true", "conditional": true}, {"kind": "constant", "value": "false", "conditional": false}]}, "message": "", "actionId": "1171406604366454787", "severity": "medium", "conditional": false, "variableName": "isFromBillWasDirectComm"}], "name": "Is From Bill Was Direct Comm", "unitId": "1171406604366454786", "conditional": false}, {"do": [{"type": "copy-to-memory", "source": {"kind": "computed", "type": "case-then", "parameters": [{"on": {"filters": [{"left": {"kind": "constant", "value": "{toBill.billType}"}, "right": {"kind": "constant", "value": "DIRECT_PREM"}, "operator": "equals"}], "jointType": "and"}, "kind": "topic", "topicId": "1010300008295814144", "factorId": "3202ca669cc24261a68951e412154e9f", "conditional": true}, {"kind": "constant", "value": "", "conditional": false}]}, "message": "", "actionId": "1186719231695019011", "severity": "medium", "conditional": false, "variableName": "toCommDNCNRefNo"}], "name": "mapping toCommDNCNRefNo", "unitId": "1186719231695019010", "conditional": false}, {"do": [{"type": "copy-to-memory", "source": {"kind": "computed", "type": "case-then", "parameters": [{"on": {"filters": [{"left": {"kind": "constant", "value": "{toBill.lifePolicyRenewalId}"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}], "jointType": "and"}, "kind": "constant", "value": "{toLifePolicyRenewal.effDate}", "conditional": true}, {"kind": "constant", "value": "{toBill.due_date}", "conditional": false}]}, "message": "", "actionId": "1210293521849275403", "severity": "medium", "conditional": false, "variableName": "toDueDate"}], "name": "toDueDate", "unitId": "1210293521849275402", "conditional": false}, {"do": [{"type": "copy-to-memory", "source": {"kind": "computed", "type": "case-then", "parameters": [{"on": {"filters": [{"left": {"kind": "constant", "value": "{toBill.lifePolicyRenewalId}"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}], "jointType": "and"}, "kind": "constant", "value": "{toLifePolicyRenewal.seq}", "conditional": true}, {"kind": "constant", "value": "{toBill.billSeq}", "conditional": false}]}, "message": "", "actionId": "1210523479699903493", "severity": "medium", "conditional": false, "variableName": "toInstallmentNo"}], "name": "toInstallmentNo", "unitId": "1210523479699903492", "conditional": false}, {"do": [{"by": {"filters": [{"left": {"kind": "constant", "value": "{toBillRefId}"}, "right": {"kind": "topic", "topicId": "1151162844587810816", "factorId": "6d9bc8325c25439098fdeac0d6bb1263"}, "operator": "equals"}], "jointType": "and"}, "type": "insert-or-merge-row", "mapping": [{"source": {"kind": "constant", "value": "{toAlterationType}"}, "factorId": "7e06ca2945f9405f86844a004c858009", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "{toPolicyNum}"}, "factorId": "6f9803baae164b3bb77447652e1cfc52", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "{billReNum}"}, "factorId": "d9a0c783d822471f8a274384bbf66559", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "{toDueDate}"}, "factorId": "94c66deb1fa54509ae5b78fe34a2e113", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "{toAppropriationDate}"}, "factorId": "cf508b7bcecc4c4dbd27409aa4356fcb", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "{toAppropriationType}"}, "factorId": "af3af4406aeb4604830e308d4ba6cea2", "arithmetic": "none"}, {"source": {"kind": "constant", "value": ""}, "factorId": "694dd72e481a43d3b88cfaadffe47708", "arithmetic": "none"}, {"source": {"kind": "constant", "value": ""}, "factorId": "99dc38414fb64ae6baa45a32bac00bc0", "arithmetic": "none"}, {"source": {"kind": "constant", "value": ""}, "factorId": "a39e19560eec480b8728cd8c55d79351", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "{ANP}"}, "factorId": "da90f4e6f40848a5a2d43263473a8999", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "{APP}"}, "factorId": "62d59d8d2153419e99e5a5e9ea26e3df", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "0"}, "factorId": "668f9230bdc243139424e7b89513875e", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "0"}, "factorId": "ed89770d8009494ebf4237c0e9f2344a", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "{toAppropriationAmount}"}, "factorId": "84ee4e96a88647c5b02d471a22691daf", "arithmetic": "none"}, {"source": {"kind": "constant", "value": ""}, "factorId": "f124f17bbbfa4cac92302029706c41a0", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "1"}, "factorId": "afccc2f006b249a7bc2197a134bebb8d", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "{comissionRef}"}, "factorId": "fbfcda8fc96d489a90d8926462ceba3e", "arithmetic": "none"}, {"source": {"kind": "computed", "type": "case-then", "parameters": [{"on": {"filters": [{"left": {"kind": "constant", "value": "{toBill.lifePolicyRenewalId}"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}], "jointType": "and"}, "kind": "constant", "value": "NA", "conditional": true}]}, "factorId": "49db592272ec45e5acdc403fcd52d427", "arithmetic": "none"}, {"source": {"kind": "constant", "value": ""}, "factorId": "0e758aa778bd4a6692053be913ba3cf5", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "{toTransactionReferenceNumber}"}, "factorId": "e36532e27ae849bf82982b8841c068f6", "arithmetic": "none"}, {"source": {"kind": "topic", "topicId": "1010300008295814144", "factorId": "dfa03510a4424cbdbe503d6f113948e1"}, "factorId": "c6749c1bc0bc4f1bac387a5e031e01cd", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "{toAppropriationDate}"}, "factorId": "26f111d14ae643a6a06465691283a420", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "{toBillRefId}"}, "factorId": "6d9bc8325c25439098fdeac0d6bb1263", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "BIX"}, "factorId": "65dc4cc9c5654479836e7c72bbf34a42", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "{toCommDNCNRefNo}"}, "factorId": "fbfcda8fc96d489a90d8926462ceba3e", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "{toInstallmentNo}"}, "factorId": "5ad6304fe2974c5a8475f4d2cd08173f", "arithmetic": "none"}], "message": "", "topicId": "1151162844587810816", "actionId": "1160897157479222298", "severity": "medium", "conditional": false}], "on": {"filters": [{"left": {"kind": "topic", "topicId": "1010300008295814144", "factorId": "d680419346054fff8b231f112c2e4091"}, "right": {"kind": "constant", "value": "true"}, "operator": "equals"}, {"left": {"kind": "constant", "value": "{isFromBillWasDirectComm}"}, "right": {"kind": "constant", "value": "false"}, "operator": "equals"}], "jointType": "and"}, "name": "data mapping", "unitId": "1160897157479222297", "conditional": true}], "stageId": "1160897157479222278", "conditional": true}]', enabled=1, validated=1, tenant_id='1013492659824011264', created_at='2023-10-08 10:06:53', created_by='1013492910945380352', last_modified_at='2024-03-13 10:02:56', last_modified_by='1013492910945380352', version=62
WHERE pipeline_id='1160639471122598912';

UPDATE pipelines
SET topic_id='1010300843897639936', name='DMS Mapping WriteOff To Premium', `type`='insert-or-merge', prerequisite_enabled=1, prerequisite_on='{"filters": [{"left": {"kind": "topic", "topicId": "1010300843897639936", "factorId": "56e9bc8b11594968a90011bbec1242a6"}, "right": {"kind": "constant", "value": "DN,CN"}, "operator": "in"}, {"left": {"kind": "topic", "topicId": "1010300843897639936", "factorId": "c314eb3547494b198786ff042716f0b7"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}, {"left": {"kind": "topic", "topicId": "1010300843897639936", "factorId": "e850f49827a24a118b2bd38486cc988d"}, "right": {"kind": "constant", "value": "true"}, "operator": "equals"}], "jointType": "and"}', stages='[{"name": "load data", "units": [{"do": [{"by": {"filters": [{"left": {"kind": "topic", "topicId": "1010300621549196288", "factorId": "f0a6acd0ae754896a8bab5bc055bb45a"}, "right": {"kind": "topic", "topicId": "1010300843897639936", "factorId": "85c59e375577412094803680b35e01d8"}, "operator": "equals"}], "jointType": "and"}, "type": "read-row", "message": "", "topicId": "1010300621549196288", "actionId": "1216694489951984643", "severity": "medium", "conditional": false, "variableName": "writeOff"}], "name": "load writeOff", "unitId": "1216694489951984642", "conditional": false}, {"do": [{"by": {"filters": [{"left": {"kind": "topic", "topicId": "1010301439824352256", "factorId": "a5a25793c4a24c8683fe2b00cd76bad5"}, "right": {"kind": "topic", "topicId": "1010300843897639936", "factorId": "c314eb3547494b198786ff042716f0b7"}, "operator": "equals"}], "jointType": "and"}, "type": "read-row", "source": {"kind": "constant", "value": ""}, "message": "", "topicId": "1010301439824352256", "actionId": "1216702962299264001", "severity": "medium", "conditional": false, "variableName": "bill"}], "name": "load bill", "unitId": "1216702962299264000", "conditional": false}, {"do": [{"by": {"filters": [{"left": {"kind": "topic", "topicId": "1141797703400318976", "factorId": "cc0ef369fcf94abc90146dba2f04355d"}, "right": {"kind": "constant", "value": "{bill.lifePolicyRenewalId}"}, "operator": "equals"}], "jointType": "and"}, "type": "read-row", "message": "", "topicId": "1141797703400318976", "actionId": "1216702962299264003", "severity": "medium", "conditional": false, "variableName": "lifePolicyRenewal"}], "on": {"filters": [{"left": {"kind": "constant", "value": "{bill.lifePolicyRenewalId}"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}], "jointType": "and"}, "name": "load lifePolicyRenewal", "unitId": "1216702962299264002", "conditional": true}], "stageId": "1216694489951984641", "conditional": false}, {"name": "mapping fields", "units": [{"do": [{"type": "copy-to-memory", "source": {"kind": "computed", "type": "case-then", "parameters": [{"on": {"filters": [{"left": {"kind": "constant", "value": "{writeOff.status}"}, "right": {"kind": "constant", "value": "REVERSED"}, "operator": "equals"}, {"left": {"kind": "topic", "topicId": "1010300843897639936", "factorId": "e3f6fffc28704d239fa228742f649110"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}], "jointType": "and"}, "kind": "constant", "value": "FULLYPAIDREVERSAL", "conditional": true}, {"kind": "constant", "value": "FULLYPAID", "conditional": false}]}, "message": "", "actionId": "1216702962299264006", "severity": "medium", "conditional": false, "variableName": "alterationType"}], "name": "alterationType", "unitId": "1216702962299264005", "conditional": false}, {"do": [{"type": "copy-to-memory", "source": {"kind": "constant", "value": "{writeOff.createdAt}"}, "message": "", "actionId": "1216702962299264008", "severity": "medium", "conditional": false, "variableName": "appropriationDate"}], "name": "appropriationDate", "unitId": "1216702962299264007", "conditional": false}, {"do": [{"type": "copy-to-memory", "source": {"kind": "computed", "type": "case-then", "parameters": [{"on": {"filters": [{"left": {"kind": "constant", "value": "{writeOff.status}"}, "right": {"kind": "constant", "value": "REVERSED"}, "operator": "equals"}, {"left": {"kind": "topic", "topicId": "1010300843897639936", "factorId": "e3f6fffc28704d239fa228742f649110"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}], "jointType": "and"}, "kind": "constant", "value": "ACCRUAL", "conditional": true}, {"kind": "constant", "value": "PAID", "conditional": false}]}, "message": "", "actionId": "1216702962299264010", "severity": "medium", "conditional": false, "variableName": "appropriationType"}], "name": "appropriationType", "unitId": "1216702962299264009", "conditional": false}, {"do": [{"type": "copy-to-memory", "source": {"kind": "computed", "type": "case-then", "parameters": [{"on": {"filters": [{"left": {"kind": "constant", "value": "{bill.ma_no}"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}], "jointType": "and"}, "kind": "constant", "value": "{bill.ma_no}", "conditional": true}, {"kind": "constant", "value": "{bill.policy_no}", "conditional": false}]}, "message": "", "actionId": "1216702962299264012", "severity": "medium", "conditional": false, "variableName": "policyNum"}], "name": "policyNum", "unitId": "1216702962299264011", "conditional": false}, {"do": [{"type": "copy-to-memory", "source": {"kind": "computed", "type": "case-then", "parameters": [{"on": {"filters": [{"left": {"kind": "constant", "value": "{bill.bizType}"}, "right": {"kind": "constant", "value": "ENDO"}, "operator": "equals"}], "jointType": "and"}, "kind": "constant", "value": "ED{bill.endo_no}", "conditional": true}, {"on": {"filters": [{"left": {"kind": "constant", "value": "{bill.declaration_no}"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}], "jointType": "and"}, "kind": "constant", "value": "DL{bill.declaration_no}", "conditional": true}, {"kind": "constant", "value": "{bill.bizType}{policyNum}", "conditional": false}]}, "message": "", "actionId": "1216702962299264014", "severity": "medium", "conditional": false, "variableName": "transactionReferenceNumber"}], "name": "transactionReferenceNumber", "unitId": "1216702962299264013", "conditional": false}, {"do": [{"type": "copy-to-memory", "source": {"kind": "computed", "type": "case-then", "parameters": [{"on": {"filters": [{"left": {"kind": "constant", "value": "{bill.lifePolicyRenewalId}"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}], "jointType": "and"}, "kind": "constant", "value": "{lifePolicyRenewal.effDate}", "conditional": true}, {"kind": "constant", "value": "{bill.due_date}", "conditional": false}]}, "message": "", "actionId": "1216702962299264016", "severity": "medium", "conditional": false, "variableName": "dueDate"}], "name": "dueDate", "unitId": "1216702962299264015", "conditional": false}, {"do": [{"type": "copy-to-memory", "source": {"kind": "computed", "type": "case-then", "parameters": [{"on": {"filters": [{"left": {"kind": "constant", "value": "{bill.lifePolicyRenewalId}"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}], "jointType": "and"}, "kind": "constant", "value": "{lifePolicyRenewal.seq}", "conditional": true}, {"kind": "constant", "value": "{bill.billSeq}", "conditional": false}]}, "message": "", "actionId": "1216702962299264018", "severity": "medium", "conditional": false, "variableName": "installmentNo"}], "name": "installmentNo", "unitId": "1216702962299264017", "conditional": false}, {"do": [{"type": "copy-to-memory", "source": {"kind": "computed", "type": "case-then", "parameters": [{"on": {"filters": [{"left": {"kind": "constant", "value": "{bill.lifePolicyRenewalId}"}, "right": {"kind": "constant", "value": ""}, "operator": "not-empty"}], "jointType": "and"}, "kind": "constant", "value": "NA", "conditional": true}]}, "message": "", "actionId": "1216702962299264020", "severity": "medium", "conditional": false, "variableName": "streamStatus"}], "name": "streamStatus", "unitId": "1216702962299264019", "conditional": false}], "stageId": "1216702962299264004", "conditional": false}, {"name": " mapping to La_Premium", "units": [{"do": [{"by": {"filters": [{"left": {"kind": "topic", "topicId": "1151162844587810816", "factorId": "6d9bc8325c25439098fdeac0d6bb1263"}, "right": {"kind": "topic", "topicId": "1010300843897639936", "factorId": "61cb308231f445aaac741e53bbbfc514"}, "operator": "equals"}], "jointType": "and"}, "type": "insert-or-merge-row", "mapping": [{"source": {"kind": "topic", "topicId": "1010300843897639936", "factorId": "61cb308231f445aaac741e53bbbfc514"}, "factorId": "6d9bc8325c25439098fdeac0d6bb1263", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "{alterationType}"}, "factorId": "7e06ca2945f9405f86844a004c858009", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "{policyNum}"}, "factorId": "6f9803baae164b3bb77447652e1cfc52", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "{bill.billRefNo}"}, "factorId": "d9a0c783d822471f8a274384bbf66559", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "{dueDate}"}, "factorId": "94c66deb1fa54509ae5b78fe34a2e113", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "{appropriationDate}"}, "factorId": "cf508b7bcecc4c4dbd27409aa4356fcb", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "{appropriationType}"}, "factorId": "af3af4406aeb4604830e308d4ba6cea2", "arithmetic": "none"}, {"source": {"kind": "constant", "value": ""}, "factorId": "694dd72e481a43d3b88cfaadffe47708", "arithmetic": "none"}, {"source": {"kind": "constant", "value": ""}, "factorId": "99dc38414fb64ae6baa45a32bac00bc0", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "{bill.pay_mode}"}, "factorId": "a39e19560eec480b8728cd8c55d79351", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "0"}, "factorId": "da90f4e6f40848a5a2d43263473a8999", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "0"}, "factorId": "62d59d8d2153419e99e5a5e9ea26e3df", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "0"}, "factorId": "668f9230bdc243139424e7b89513875e", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "0"}, "factorId": "ed89770d8009494ebf4237c0e9f2344a", "arithmetic": "none"}, {"source": {"kind": "computed", "type": "multiply", "parameters": [{"kind": "constant", "value": "{bill.amount}"}, {"kind": "constant", "value": "{bill.drcr}"}]}, "factorId": "84ee4e96a88647c5b02d471a22691daf", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "1"}, "factorId": "afccc2f006b249a7bc2197a134bebb8d", "arithmetic": "none"}, {"source": {"kind": "constant", "value": ""}, "factorId": "f124f17bbbfa4cac92302029706c41a0", "arithmetic": "none"}, {"source": {"kind": "topic", "topicId": "1010300843897639936", "factorId": "b2f2c4a79b0d4048bd027625df31ef95"}, "factorId": "fbfcda8fc96d489a90d8926462ceba3e", "arithmetic": "none"}, {"source": {"kind": "constant", "value": ""}, "factorId": "0e758aa778bd4a6692053be913ba3cf5", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "{transactionReferenceNumber}"}, "factorId": "e36532e27ae849bf82982b8841c068f6", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "{appropriationDate}"}, "factorId": "26f111d14ae643a6a06465691283a420", "arithmetic": "none"}, {"source": {"kind": "topic", "topicId": "1010300843897639936", "factorId": "1857a1bd13ee442c86bf996b5053eb5f"}, "factorId": "c6749c1bc0bc4f1bac387a5e031e01cd", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "{streamStatus}"}, "factorId": "49db592272ec45e5acdc403fcd52d427", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "BIX"}, "factorId": "65dc4cc9c5654479836e7c72bbf34a42", "arithmetic": "none"}, {"source": {"kind": "constant", "value": "{installmentNo}"}, "factorId": "5ad6304fe2974c5a8475f4d2cd08173f", "arithmetic": "none"}], "message": "", "topicId": "1151162844587810816", "actionId": "1216702962299264023", "severity": "medium", "conditional": false}], "on": {"filters": [{"left": {"kind": "constant", "value": "{bill.billType}"}, "right": {"kind": "constant", "value": "DIRECT_PREM"}, "operator": "equals"}, {"left": {"kind": "topic", "topicId": "1010300843897639936", "factorId": "be662fa9bf174006a7ed1d5a2c7f38c6"}, "right": {"kind": "constant", "value": "true"}, "operator": "equals"}], "jointType": "and"}, "name": "mapping data", "unitId": "1216702962299264022", "conditional": true}], "stageId": "1216702962299264021", "conditional": false}]', enabled=1, validated=1, tenant_id='1013492659824011264', created_at='2024-03-11 02:29:31', created_by='1013492910945380352', last_modified_at='2024-03-13 10:04:02', last_modified_by='1013492910945380352', version=10
WHERE pipeline_id='1216694489951984640';