> 注：**Staging Count**的值与**Migrated System Count**都一样，所以没有单独列出

### 1-Policy count identified for migration 

> 从我们系统查询Total System Count，从Watchmen数据库查询Migrated Count
>
> 测试时可以添加时间范围来统计数据
>
> * 1.在Core系统这边选定一个时间段的数据同步到watchmen，如十月的数据，那么在Core查询时添加条件
>   * created_at between '2023-10-01 00:00:00' and '2023-10-31 23:59:59'
> * 2.在Watchmen查询数据时添加条件：
>   * createdat between '2023-10-01 00:00:00' and '2023-10-31 23:59:59'
>     		and update_time_ >= '2023-12-05 00:00:00'
>   * 说明：用Core数据createat和Watchmen数据更新时间update_time_ 两个条件来框选数据

~~~sql
# BIX
select
	quote_status Status,
	count(*) 'Total System Count'
from
	trans_index
where
	biz_type in ("NB", "RN")
group by
	quote_status
order by
	quote_status;
~~~

~~~sql
# Watchman
select
	policystatus Status,
	count(*) 'Migrated Count'
from
	topic_policy
group by
	policystatus
order by
	policystatus ;
~~~

### 2-Policy Status wise counts

> DM相关表也可以添加时间条件来框选数据
>
> * extractiondate >= '2023-12-05 00:00:00' 

~~~sql
select
	policystatuscd Status,
	policystatusreason 'Lapsed/Terminated Reason' ,
	count(*) 'Migrated System Count',
	count(*) 'Staging Count',
	0  'Difference'
from
	topic_dmpolicyheader
group by
	policystatuscd ,
	policystatusreason ;
~~~
~~~text
# Status, Lapsed/Terminated Reason, Migrated System Count, Staging Count, Difference
ISSUED, , 18858, 18858, 0
CANCELLED, MC04, 244, 244, 0
CANCELLED, MC02, 121, 121, 0
~~~

### 3-Agent wise Policy Status wise

~~~sql
select
	agentid 'Agent Code',
	policystatuscd 'Policy Status' ,
	count(*) 'Count'
from
	topic_dmpolicyheader
group by
	agentid ,
	policystatuscd
order by
	agentid ;

# Agent Code, Policy Status, Count
074984, ISSUED, 1
19444, ISSUED, 1
334208, ISSUED, 1
406002, ISSUED, 1
423988, ISSUED, 6
426066, ISSUED, 5
457873, ISSUED, 2
512064, ISSUED, 1
512132, ISSUED, 3
512598, ISSUED, 2
512637, CANCELLED, 1
512637, ISSUED, 12
512886, ISSUED, 5
513979, ISSUED, 3
514282, ISSUED, 1
514431, ISSUED, 2
514541, ISSUED, 1
514622, ISSUED, 3
514729, ISSUED, 6
514745, ISSUED, 1
514761, ISSUED, 1
514907, ISSUED, 2
514952, ISSUED, 2
515249, ISSUED, 20
515375, ISSUED, 3
515618, ISSUED, 1
515650, ISSUED, 7
515757, ISSUED, 14
516248, ISSUED, 4
516280, ISSUED, 6
516400, ISSUED, 16
516471, ISSUED, 2
516837, CANCELLED, 2
516837, ISSUED, 46
516989, ISSUED, 1
517124, ISSUED, 4
517166, CANCELLED, 4
517166, ISSUED, 240
517496, ISSUED, 2
517632, ISSUED, 5
517658, ISSUED, 1
517661, ISSUED, 1
517881, ISSUED, 1
518343, ISSUED, 1
518385, ISSUED, 1
518770, ISSUED, 2
518796, ISSUED, 1
518835, ISSUED, 1
518893, ISSUED, 4
519148, ISSUED, 6
519164, ISSUED, 1
519203, ISSUED, 2
519407, ISSUED, 1
519452, ISSUED, 2
519575, CANCELLED, 2
519575, ISSUED, 60
519740, CANCELLED, 1
519740, ISSUED, 40
519847, ISSUED, 2
519986, ISSUED, 1
520069, ISSUED, 3
520292, ISSUED, 1
520441, ISSUED, 5
520878, ISSUED, 3
521042, ISSUED, 4
521110, CANCELLED, 1
521110, ISSUED, 9
521204, ISSUED, 11
521770, CANCELLED, 1
521770, ISSUED, 52
521822, ISSUED, 3
521903, ISSUED, 2
522041, ISSUED, 1
522274, ISSUED, 1
522562, ISSUED, 1
522591, ISSUED, 2
522656, ISSUED, 7
522724, ISSUED, 2
522834, ISSUED, 3
522889, ISSUED, 1
523192, ISSUED, 5
523532, ISSUED, 2
524230, ISSUED, 5
524243, ISSUED, 18
524670, ISSUED, 1
524722, ISSUED, 2
524751, ISSUED, 15
524845, ISSUED, 1
524984, ISSUED, 1
525161, ISSUED, 1
525255, ISSUED, 4
525297, ISSUED, 3
525394, ISSUED, 3
525488, ISSUED, 9
525491, ISSUED, 3
525501, CANCELLED, 1
525501, ISSUED, 2
525572, ISSUED, 10
525608, CANCELLED, 2
525608, ISSUED, 17
526021, ISSUED, 2
526348, ISSUED, 1
526500, ISSUED, 1
526898, ISSUED, 2
526908, ISSUED, 2
526911, ISSUED, 3
526924, ISSUED, 3
526937, ISSUED, 2
526982, ISSUED, 1
527017, ISSUED, 1
527020, CANCELLED, 1
527020, ISSUED, 21
527130, ISSUED, 24
527211, ISSUED, 5
527457, ISSUED, 10
527677, ISSUED, 3
527703, ISSUED, 48
527813, ISSUED, 1
527952, ISSUED, 1
527994, ISSUED, 7
528003, ISSUED, 2
528058, ISSUED, 4
528139, CANCELLED, 2
528139, ISSUED, 66
528388, ISSUED, 2
528595, ISSUED, 12
528760, ISSUED, 2
529167, ISSUED, 1
529895, ISSUED, 4
529947, CANCELLED, 10
529947, ISSUED, 105
530127, ISSUED, 2
530130, CANCELLED, 1
530130, ISSUED, 18
530321, ISSUED, 2
530826, ISSUED, 7
531197, ISSUED, 1
531223, ISSUED, 1
531621, ISSUED, 1
533072, ISSUED, 5
534576, ISSUED, 2
534589, ISSUED, 1
534738, ISSUED, 1
534806, CANCELLED, 1
534806, ISSUED, 22
534961, ISSUED, 1
535261, ISSUED, 1
535847, ISSUED, 1
536095, CANCELLED, 1
536095, ISSUED, 9
536312, CANCELLED, 1
536312, ISSUED, 2
536516, ISSUED, 3
536736, ISSUED, 2
536752, ISSUED, 1
536943, ISSUED, 1
536972, ISSUED, 4
537017, ISSUED, 16
537034, ISSUED, 1
537071, ISSUED, 2
537150, CANCELLED, 1
537150, ISSUED, 9
537154, ISSUED, 10
537167, ISSUED, 1
537189, ISSUED, 1
537191, ISSUED, 1
537194, ISSUED, 3
537195, CANCELLED, 1
537195, ISSUED, 25
537197, ISSUED, 8
537198, ISSUED, 1
537199, ISSUED, 1
537200, ISSUED, 10
537213, ISSUED, 6
537255, ISSUED, 1
537258, ISSUED, 11
537293, ISSUED, 1
537304, ISSUED, 4
537309, ISSUED, 12
537320, ISSUED, 2
537328, ISSUED, 4
537340, CANCELLED, 1
537340, ISSUED, 39
537346, ISSUED, 1
537353, ISSUED, 3
537356, ISSUED, 3
537369, ISSUED, 8
537428, ISSUED, 2
537468, ISSUED, 2
537474, ISSUED, 1
537486, ISSUED, 1
537501, ISSUED, 1
537519, ISSUED, 1
537526, ISSUED, 1
537536, ISSUED, 2
537541, ISSUED, 2
537665, ISSUED, 3
537708, CANCELLED, 1
537708, ISSUED, 1
537723, ISSUED, 3
537734, ISSUED, 3
537753, ISSUED, 4
537760, ISSUED, 1
537762, ISSUED, 3
537808, ISSUED, 1
537833, ISSUED, 1
537837, ISSUED, 1
537861, ISSUED, 1
537898, CANCELLED, 2
537898, ISSUED, 17
537926, ISSUED, 1
537950, CANCELLED, 1
537950, ISSUED, 1
537959, ISSUED, 2
537965, CANCELLED, 1
537965, ISSUED, 1
537997, ISSUED, 1
538002, ISSUED, 6
538014, ISSUED, 7
538015, ISSUED, 10
538033, CANCELLED, 2
538033, ISSUED, 71
538034, ISSUED, 1
538037, ISSUED, 5
538061, ISSUED, 1
538066, ISSUED, 1
538086, ISSUED, 3
538098, ISSUED, 1
538103, ISSUED, 1
538106, ISSUED, 5
538112, ISSUED, 2
538115, ISSUED, 8
538116, ISSUED, 2
538117, ISSUED, 3
538126, CANCELLED, 1
538126, ISSUED, 14
538139, ISSUED, 1
538142, ISSUED, 3
538187, ISSUED, 1
538192, ISSUED, 1
538194, ISSUED, 1
538204, ISSUED, 1
538225, ISSUED, 12
538232, ISSUED, 1
538272, ISSUED, 1
538276, ISSUED, 1
538281, CANCELLED, 1
538281, ISSUED, 5
538284, ISSUED, 1
538294, ISSUED, 4
538302, ISSUED, 2
538329, ISSUED, 1
538331, ISSUED, 1
538336, ISSUED, 1
538355, ISSUED, 1
538356, ISSUED, 1
550015, ISSUED, 1
550034, CANCELLED, 1
550034, ISSUED, 6
550069, ISSUED, 3
550074, ISSUED, 2
550082, CANCELLED, 1
550082, ISSUED, 21
550101, ISSUED, 1
550124, CANCELLED, 3
550124, ISSUED, 4
550138, ISSUED, 2
550143, ISSUED, 1
550144, ISSUED, 3
550152, ISSUED, 1
550160, ISSUED, 1
550163, ISSUED, 1
550165, ISSUED, 1
550191, ISSUED, 1
550196, ISSUED, 2
550200, ISSUED, 1
550205, ISSUED, 8
550214, ISSUED, 2
550248, ISSUED, 2
550251, ISSUED, 1
550253, ISSUED, 1
550259, ISSUED, 2
570899, ISSUED, 1
571115, ISSUED, 6
571322, ISSUED, 32
571335, ISSUED, 12
571652, ISSUED, 38
571678, ISSUED, 20
571791, ISSUED, 3
571872, ISSUED, 2
571898, ISSUED, 6
571908, CANCELLED, 12
571908, ISSUED, 263
571924, ISSUED, 16
571953, ISSUED, 30
572062, ISSUED, 1
572101, ISSUED, 1
572130, ISSUED, 1
572208, CANCELLED, 4
572208, ISSUED, 277
572240, ISSUED, 2
572253, ISSUED, 5
572460, ISSUED, 34
572473, ISSUED, 11
572486, ISSUED, 17
572525, ISSUED, 5
572538, ISSUED, 36
572570, CANCELLED, 3
572570, ISSUED, 81
572651, CANCELLED, 9
572651, ISSUED, 724
572664, ISSUED, 1
572680, ISSUED, 6
572703, ISSUED, 8
572716, ISSUED, 75
572787, CANCELLED, 4
572787, ISSUED, 351
572800, ISSUED, 201
572813, ISSUED, 10
572868, ISSUED, 13
572907, CANCELLED, 1
572907, ISSUED, 59
572910, CANCELLED, 1
572910, ISSUED, 3
572923, ISSUED, 10
572936, ISSUED, 58
572952, ISSUED, 1
572978, ISSUED, 11
572981, ISSUED, 32
573045, ISSUED, 4
573061, ISSUED, 8
573087, ISSUED, 10
573090, CANCELLED, 2
573090, ISSUED, 99
573113, ISSUED, 5
573126, CANCELLED, 1
573126, ISSUED, 6
573155, ISSUED, 7
573168, ISSUED, 57
573171, CANCELLED, 2
573171, ISSUED, 29
573184, ISSUED, 42
573207, ISSUED, 2
573210, ISSUED, 9
573236, ISSUED, 26
573265, ISSUED, 7
573278, ISSUED, 3
573359, ISSUED, 3
573362, CANCELLED, 2
573362, ISSUED, 82
573375, ISSUED, 50
573430, ISSUED, 51
573443, ISSUED, 9
573469, ISSUED, 8
573472, ISSUED, 37
573511, CANCELLED, 4
573511, ISSUED, 349
573524, ISSUED, 2
573540, ISSUED, 18
573650, CANCELLED, 1
573650, ISSUED, 135
573663, ISSUED, 1
573676, ISSUED, 17
573689, ISSUED, 2
573773, CANCELLED, 1
573773, ISSUED, 41
573775, ISSUED, 1
573776, CANCELLED, 1
573776, ISSUED, 27
573781, ISSUED, 3
573809, ISSUED, 26
573812, ISSUED, 23
573828, ISSUED, 24
573829, ISSUED, 3
573830, CANCELLED, 3
573830, ISSUED, 71
573832, CANCELLED, 4
573832, ISSUED, 83
573837, ISSUED, 8
573839, ISSUED, 3
573843, CANCELLED, 1
573843, ISSUED, 73
573844, ISSUED, 10
573846, ISSUED, 49
573850, CANCELLED, 1
573850, ISSUED, 39
573856, ISSUED, 67
573863, CANCELLED, 2
573863, ISSUED, 13
573864, ISSUED, 27
573866, CANCELLED, 2
573866, ISSUED, 160
573868, ISSUED, 27
573872, ISSUED, 24
573874, CANCELLED, 1
573874, ISSUED, 15
573876, ISSUED, 8
573877, ISSUED, 1
573878, ISSUED, 1
580217, ISSUED, 2
580317, ISSUED, 2
580342, ISSUED, 2
580417, ISSUED, 4
580422, ISSUED, 17
580546, ISSUED, 4
580594, ISSUED, 1
580595, ISSUED, 1
580700, ISSUED, 1
580701, ISSUED, 4
580734, ISSUED, 4
580743, CANCELLED, 1
580743, ISSUED, 2
580856, ISSUED, 1
580869, ISSUED, 2
580876, ISSUED, 5
580894, ISSUED, 9
580917, ISSUED, 2
581200, CANCELLED, 1
581200, ISSUED, 45
581222, ISSUED, 2
581227, ISSUED, 1
581236, ISSUED, 1
581246, ISSUED, 3
581253, ISSUED, 1
581254, ISSUED, 5
581265, ISSUED, 1
581269, ISSUED, 4
581300, ISSUED, 1
581301, ISSUED, 3
581397, ISSUED, 5
582603, CANCELLED, 1
582603, ISSUED, 4
582630, ISSUED, 2
582672, ISSUED, 1
582679, ISSUED, 1
582688, ISSUED, 3
583136, ISSUED, 1
583145, ISSUED, 1
583154, ISSUED, 1
583162, ISSUED, 3
583194, ISSUED, 19
583230, ISSUED, 16
583244, ISSUED, 1
583275, ISSUED, 1
583517, ISSUED, 2
583530, ISSUED, 1
583535, ISSUED, 1
583546, ISSUED, 2
583756, ISSUED, 1
583910, ISSUED, 1
583923, ISSUED, 3
583952, ISSUED, 1
583977, ISSUED, 1
584012, ISSUED, 1
584016, ISSUED, 3
584042, ISSUED, 10
584053, CANCELLED, 1
584079, ISSUED, 1
584260, ISSUED, 2
584345, ISSUED, 3
584395, ISSUED, 4
584398, ISSUED, 1
584416, ISSUED, 1
584701, ISSUED, 1
584902, ISSUED, 1
584906, ISSUED, 1
584915, ISSUED, 4
584925, ISSUED, 1
584928, ISSUED, 2
584946, ISSUED, 1
584947, ISSUED, 1
584962, ISSUED, 7
584970, ISSUED, 1
584971, ISSUED, 1
584978, ISSUED, 1
584979, ISSUED, 1
584985, CANCELLED, 1
584985, ISSUED, 3
585004, ISSUED, 3
585018, CANCELLED, 1
585018, ISSUED, 25
585020, ISSUED, 7
585097, CANCELLED, 2
585097, ISSUED, 20
585103, ISSUED, 1
585109, ISSUED, 2
585127, ISSUED, 2
585159, ISSUED, 4
585189, ISSUED, 1
585192, ISSUED, 1
585199, ISSUED, 1
585237, ISSUED, 84
585242, ISSUED, 2
585350, CANCELLED, 1
585350, ISSUED, 8
585402, CANCELLED, 2
585402, ISSUED, 81
585410, ISSUED, 1
585441, ISSUED, 23
585458, ISSUED, 2
585465, ISSUED, 2
585470, CANCELLED, 2
585470, ISSUED, 41
585517, ISSUED, 1
585555, ISSUED, 1
585590, ISSUED, 4
585591, ISSUED, 5
585706, ISSUED, 3
585730, ISSUED, 1
585733, CANCELLED, 1
585733, ISSUED, 6
585742, ISSUED, 1
585743, ISSUED, 3
585779, ISSUED, 1
585830, ISSUED, 7
585847, ISSUED, 1
585851, ISSUED, 2
585882, ISSUED, 1
585900, CANCELLED, 2
585900, ISSUED, 11
585907, ISSUED, 1
585916, ISSUED, 4
585982, CANCELLED, 1
586000, ISSUED, 2
586003, ISSUED, 1
586012, ISSUED, 1
586029, ISSUED, 1
586033, ISSUED, 8
586043, ISSUED, 2
586082, ISSUED, 1
586154, ISSUED, 2
586180, CANCELLED, 2
586180, ISSUED, 34
586320, ISSUED, 4
586397, CANCELLED, 1
586397, ISSUED, 3
586415, ISSUED, 1
586465, ISSUED, 6
586498, ISSUED, 1
586824, ISSUED, 3
586828, ISSUED, 1
586857, ISSUED, 2
586926, ISSUED, 12
587003, ISSUED, 1
587020, ISSUED, 1
587028, ISSUED, 2
587075, ISSUED, 1
587079, ISSUED, 10
587107, ISSUED, 33
587120, ISSUED, 1
587123, ISSUED, 1
587128, CANCELLED, 1
587128, ISSUED, 70
587157, ISSUED, 2
587167, ISSUED, 1
587176, ISSUED, 1
587177, ISSUED, 3
587180, CANCELLED, 1
587180, ISSUED, 17
587181, ISSUED, 2
587186, ISSUED, 1
587205, ISSUED, 2
587269, ISSUED, 4
587280, ISSUED, 1
587284, ISSUED, 2
587290, ISSUED, 1
587414, ISSUED, 62
587423, ISSUED, 4
587442, ISSUED, 1
587476, ISSUED, 3
587480, ISSUED, 5
587489, ISSUED, 2
587499, ISSUED, 1
587516, ISSUED, 3
587531, ISSUED, 1
587573, CANCELLED, 1
587573, ISSUED, 2
587597, ISSUED, 3
587601, ISSUED, 3
587719, ISSUED, 2
587744, ISSUED, 2
587769, ISSUED, 1
587773, ISSUED, 1
587782, CANCELLED, 1
587782, ISSUED, 4
587823, CANCELLED, 1
587823, ISSUED, 7
587825, ISSUED, 2
587839, ISSUED, 138
587847, ISSUED, 13
587848, ISSUED, 6
587851, ISSUED, 1
587882, ISSUED, 4
588112, ISSUED, 2
588122, ISSUED, 2
588127, CANCELLED, 1
588127, ISSUED, 9
588610, ISSUED, 1
588616, ISSUED, 6
588617, ISSUED, 1
588622, ISSUED, 4
588636, CANCELLED, 1
588636, ISSUED, 7
588665, ISSUED, 1
588666, ISSUED, 1
588669, ISSUED, 1
588672, ISSUED, 4
588679, ISSUED, 10
588695, ISSUED, 11
588710, CANCELLED, 1
588710, ISSUED, 45
588727, ISSUED, 2
588735, ISSUED, 1
588747, ISSUED, 4
588751, ISSUED, 1
588754, CANCELLED, 1
588754, ISSUED, 6
588764, ISSUED, 1
588775, ISSUED, 1
588794, ISSUED, 2
588832, ISSUED, 1
588851, ISSUED, 6
589329, ISSUED, 1
589330, ISSUED, 3
589359, ISSUED, 2
589361, ISSUED, 1
589422, ISSUED, 1
589433, ISSUED, 1
589470, ISSUED, 2
589711, ISSUED, 1
589731, ISSUED, 4
589788, ISSUED, 2
589794, ISSUED, 3
591085, CANCELLED, 1
591085, ISSUED, 37
591166, ISSUED, 3
591195, ISSUED, 2
591218, ISSUED, 6
591302, ISSUED, 28
591360, ISSUED, 3
591373, ISSUED, 22
591409, ISSUED, 2
591441, ISSUED, 7
591470, ISSUED, 19
591519, CANCELLED, 1
591519, ISSUED, 56
591551, ISSUED, 2
591593, ISSUED, 2
600002, ISSUED, 3
600057, ISSUED, 1
600206, ISSUED, 31
601399, ISSUED, 1
601409, ISSUED, 1
603257, ISSUED, 1
610380, CANCELLED, 1
610380, ISSUED, 35
610555, ISSUED, 16
610870, ISSUED, 2
611305, ISSUED, 9
611606, ISSUED, 2
612265, ISSUED, 20
612809, ISSUED, 6
613374, CANCELLED, 2
613374, ISSUED, 33
613565, ISSUED, 2
613840, ISSUED, 2
613918, ISSUED, 1
613934, CANCELLED, 4
613934, ISSUED, 224
614234, CANCELLED, 1
614234, ISSUED, 12
614425, ISSUED, 9
614580, CANCELLED, 1
614580, ISSUED, 25
614616, ISSUED, 6
614661, CANCELLED, 2
614661, ISSUED, 39
614797, ISSUED, 4
614852, CANCELLED, 1
614852, ISSUED, 62
614894, ISSUED, 3
614904, CANCELLED, 2
614904, ISSUED, 101
614917, ISSUED, 410
614933, ISSUED, 34
614975, CANCELLED, 1
614975, ISSUED, 225
615039, ISSUED, 1
615068, ISSUED, 107
615107, ISSUED, 1
615123, ISSUED, 16
615165, CANCELLED, 2
615165, ISSUED, 87
615246, ISSUED, 7
615275, ISSUED, 13
615292, CANCELLED, 5
615292, ISSUED, 333
615293, ISSUED, 10
615314, ISSUED, 5
615409, ISSUED, 8
615429, CANCELLED, 2
615429, ISSUED, 38
615430, ISSUED, 2
615434, ISSUED, 22
615437, CANCELLED, 2
615437, ISSUED, 21
615438, ISSUED, 1
615442, CANCELLED, 3
615442, ISSUED, 46
615445, ISSUED, 1
620968, ISSUED, 1
630101, ISSUED, 7
630107, ISSUED, 2
630146, ISSUED, 1
630156, CANCELLED, 1
630156, ISSUED, 4
630159, ISSUED, 6
630193, ISSUED, 1
630343, ISSUED, 2
630346, ISSUED, 2
630351, ISSUED, 4
630359, ISSUED, 154
630371, ISSUED, 1
630467, ISSUED, 11
630493, ISSUED, 3
630518, ISSUED, 1
630536, ISSUED, 1
630538, ISSUED, 1
630576, ISSUED, 1
630582, ISSUED, 2
630599, ISSUED, 1
630622, ISSUED, 1
630624, ISSUED, 1
630632, ISSUED, 1
630647, ISSUED, 3
630672, ISSUED, 1
630732, ISSUED, 4
630749, ISSUED, 4
630766, ISSUED, 1
630781, ISSUED, 1
630820, ISSUED, 1
630857, ISSUED, 1
630949, ISSUED, 1
630957, ISSUED, 2
630968, ISSUED, 1
630988, ISSUED, 1
631018, CANCELLED, 1
631018, ISSUED, 8
631032, ISSUED, 2
631050, ISSUED, 5
631072, ISSUED, 1
631078, ISSUED, 2
631085, ISSUED, 3
631086, ISSUED, 4
631092, ISSUED, 2
631223, ISSUED, 1
631235, CANCELLED, 1
631235, ISSUED, 4
631239, ISSUED, 3
631265, CANCELLED, 2
631265, ISSUED, 68
631266, ISSUED, 3
631267, ISSUED, 5
631274, ISSUED, 3
631275, ISSUED, 11
631276, ISSUED, 1
631282, CANCELLED, 1
631282, ISSUED, 56
631286, ISSUED, 4
631288, ISSUED, 5
631291, ISSUED, 2
631292, ISSUED, 1
631293, ISSUED, 2
631296, ISSUED, 3
631298, ISSUED, 1
631309, ISSUED, 3
631318, ISSUED, 1
631319, ISSUED, 1
631330, ISSUED, 15
631352, ISSUED, 2
631367, ISSUED, 5
631380, ISSUED, 1
631387, ISSUED, 1
631507, ISSUED, 3
631514, ISSUED, 1
631547, ISSUED, 2
631554, ISSUED, 6
631561, ISSUED, 7
631590, ISSUED, 2
631624, ISSUED, 2
631702, ISSUED, 2
631719, ISSUED, 1
631726, ISSUED, 1
631735, ISSUED, 1
631763, ISSUED, 1
631768, ISSUED, 1
631770, ISSUED, 2
631784, ISSUED, 9
631788, ISSUED, 1
631806, ISSUED, 1
631884, ISSUED, 1
631901, CANCELLED, 1
631901, ISSUED, 12
631908, ISSUED, 1
631909, ISSUED, 4
631916, ISSUED, 1
631917, CANCELLED, 2
631917, ISSUED, 10
632008, ISSUED, 1
632122, ISSUED, 1
632131, ISSUED, 1
632152, ISSUED, 11
632156, ISSUED, 1
632158, ISSUED, 1
632207, ISSUED, 1
632320, ISSUED, 14
632339, ISSUED, 3
632362, CANCELLED, 1
632362, ISSUED, 13
632384, ISSUED, 6
632393, ISSUED, 2
632394, ISSUED, 6
632398, ISSUED, 3
632453, ISSUED, 17
632473, ISSUED, 4
632480, ISSUED, 2
632484, ISSUED, 1
632485, ISSUED, 1
632539, ISSUED, 2
632544, ISSUED, 1
632573, ISSUED, 1
632605, ISSUED, 1
632627, ISSUED, 1
632815, ISSUED, 1
632823, ISSUED, 1
632853, ISSUED, 2
632860, ISSUED, 37
632863, CANCELLED, 1
632863, ISSUED, 7
632900, ISSUED, 1
632920, ISSUED, 2
632961, ISSUED, 1
633023, ISSUED, 3
633040, ISSUED, 19
633090, ISSUED, 1
633099, ISSUED, 4
633101, ISSUED, 2
633115, ISSUED, 2
633182, ISSUED, 3
633631, ISSUED, 3
633690, ISSUED, 3
633698, CANCELLED, 1
633698, ISSUED, 1
633779, ISSUED, 16
633780, ISSUED, 5
633783, ISSUED, 6
633784, ISSUED, 2
633874, ISSUED, 2
633881, ISSUED, 1
633952, ISSUED, 1
634165, ISSUED, 4
634312, ISSUED, 1
634539, ISSUED, 1
634801, ISSUED, 1
634858, ISSUED, 1
634909, ISSUED, 3
634916, ISSUED, 4
634917, ISSUED, 2
634935, ISSUED, 1
634948, ISSUED, 8
634958, ISSUED, 3
634986, ISSUED, 2
634991, ISSUED, 1
634999, ISSUED, 1
635360, ISSUED, 2
635378, ISSUED, 3
635419, ISSUED, 1
635477, ISSUED, 1
635482, ISSUED, 1
635500, ISSUED, 10
635503, ISSUED, 1
635605, CANCELLED, 1
635605, ISSUED, 4
635607, ISSUED, 1
635614, ISSUED, 1
635697, ISSUED, 1
635845, ISSUED, 3
635855, ISSUED, 1
635858, ISSUED, 2
635860, ISSUED, 1
635882, ISSUED, 1
635913, ISSUED, 3
635919, ISSUED, 3
635945, ISSUED, 1
635975, ISSUED, 1
635988, ISSUED, 1
636240, ISSUED, 3
636276, ISSUED, 2
636340, ISSUED, 1
636343, ISSUED, 3
636363, ISSUED, 1
636372, ISSUED, 1
636380, ISSUED, 1
636396, ISSUED, 6
636445, ISSUED, 1
636448, ISSUED, 10
636479, ISSUED, 1
636503, ISSUED, 3
636507, CANCELLED, 1
636507, ISSUED, 2
636508, ISSUED, 2
636523, ISSUED, 6
636526, ISSUED, 1
636532, ISSUED, 1
636598, ISSUED, 6
636605, ISSUED, 1
636709, ISSUED, 1
636733, ISSUED, 10
636759, ISSUED, 7
636777, ISSUED, 1
636790, ISSUED, 1
636801, CANCELLED, 1
636801, ISSUED, 3
636874, ISSUED, 1
637005, ISSUED, 1
637023, ISSUED, 1
637032, ISSUED, 1
637115, ISSUED, 1
637128, ISSUED, 1
637133, ISSUED, 4
637144, ISSUED, 2
637148, ISSUED, 10
637150, ISSUED, 3
637160, ISSUED, 2
637167, ISSUED, 1
637172, ISSUED, 2
637180, ISSUED, 1
637228, ISSUED, 2
637237, CANCELLED, 1
637237, ISSUED, 2
637271, ISSUED, 1
637284, ISSUED, 1
637399, ISSUED, 6
637759, ISSUED, 2
637776, ISSUED, 1
637781, ISSUED, 1
637823, ISSUED, 3
637868, ISSUED, 2
637908, CANCELLED, 1
637908, ISSUED, 6
637914, ISSUED, 1
637961, CANCELLED, 1
637961, ISSUED, 17
638430, ISSUED, 8
638550, ISSUED, 1
638631, ISSUED, 9
638639, CANCELLED, 1
638639, ISSUED, 90
638679, ISSUED, 7
638680, ISSUED, 2
638693, ISSUED, 1
638702, CANCELLED, 5
638702, ISSUED, 655
638714, ISSUED, 1
638722, ISSUED, 1
638734, ISSUED, 1
638742, ISSUED, 3
638747, ISSUED, 1
638750, ISSUED, 2
638753, ISSUED, 2
638818, ISSUED, 2
638824, ISSUED, 2
638845, ISSUED, 6
638846, ISSUED, 4
638847, ISSUED, 3
638848, ISSUED, 23
638850, ISSUED, 7
638885, ISSUED, 7
638888, ISSUED, 1
638896, ISSUED, 3
638897, ISSUED, 1
638928, ISSUED, 1
638972, ISSUED, 3
638991, ISSUED, 1
638996, ISSUED, 2
639171, ISSUED, 2
639189, ISSUED, 1
639333, ISSUED, 1
639392, ISSUED, 1
639735, ISSUED, 1
639748, ISSUED, 5
639903, ISSUED, 3
640179, ISSUED, 6
640199, ISSUED, 1
640289, ISSUED, 4
640375, ISSUED, 1
640440, ISSUED, 3
640480, ISSUED, 1
641126, ISSUED, 1
641133, ISSUED, 1

~~~

### 4-Policy Issue Year wise Policy Counts

~~~sql
select
	year(issuedt) 'Year',
	count(*) 'Migrated System Count',
	count(*) 'Staging Count',
	0 'Difference'
from
	topic_dmpolicyheader
group by
	year(issuedt)
order by
	year(issuedt) desc;

# Year, Migrated System Count, Staging Count, Difference
2023, 19223, 19223, 0

~~~

### 5-Policy Submission Year wise Policy Counts

~~~sql
select
	year(logindt) 'Year',
	count(*) 'Migrated System Count',
	count(*) 'Staging Count',
	0 'Difference'
from
	topic_dmpolicyheader
group by
	year(logindt)
order by
	year(logindt) desc;

# Year, Migrated System Count, Staging Count, Difference
2023, 19222, 19222, 0
2022, 1, 1, 0

~~~

### 6-Policy Commencement Year wise Policy Counts

~~~sql
select
	year(commencementdt) 'Year',
	count(*) 'Migrated System Count',
	count(*) 'Staging Count',
	0 'Difference'
from
	topic_dmpolicyheader
group by
	year(commencementdt)
order by
	year(commencementdt) desc;

# Year, Migrated System Count, Staging Count, Difference
2024, 520, 520, 0
2023, 18699, 18699, 0
2022, 4, 4, 0

~~~

### 7-Policy Effective End Date-Year wise Policy Counts

~~~sql
select
	year(policyeffectiveenddt) 'Year',
	count(*) 'Migrated System Count',
	count(*) 'Staging Count',
	0 'Difference'
from
	topic_dmpolicyheader
group by
	year(policyeffectiveenddt)
order by
	year(policyeffectiveenddt) desc;

# Year, Migrated System Count, Staging Count, Difference
2999, 479, 479, 0
2026, 6264, 6264, 0
2025, 1873, 1873, 0
2024, 8244, 8244, 0
2023, 2362, 2362, 0
2022, 1, 1, 0

~~~

### 8-Source Of Submission wise Counts

> 可能存在batch_admin创建数据的情况，但平台用户没有对应映射逻辑，所以sourceofsubmission为空，看是否需要补充这个映射

~~~sql
select
	sourceofsubmission 'Source Of Submission',
	count(*) 'Migrated System Count',
	count(*) 'Staging Count',
	0 'Difference'
from
	topic_dmpolicyheader
group by
	sourceofsubmission ;

# Source Of Submission, Migrated System Count, Staging Count, Difference
AGENT, 11759, 11759, 0
BACK_OFFICE, 1829, 1829, 0
, 2514, 2514, 0
CUSTOMER, 3121, 3121, 0

~~~

### 9-Endorsement  Commission Flag  wise Policy Counts

~~~sql
select
	(case
		when endorsementcommissionflag = 'Y' then 'YES'
		else 'NO'
	end) 'Endorsement Commission Flag',
	count(*) 'Migrated System Count',
	count(*) 'Staging Count',
	0 'Difference'
from
	topic_dmpolicyheader
group by
	endorsementcommissionflag;

# Endorsement Commission Flag, Migrated System Count, Staging Count, Difference
NO, 19223, 19223, 0

~~~

### 10-Commission Rate Change wise Policy Counts

~~~sql
select
	commissionratechangeflag 'Commission Rate Change Flag',
	count(*) 'Migrated System Count',
	count(*) 'Staging Count',
	0 'Difference'
from
	topic_dmpolicyproductdetails
group by
	commissionratechangeflag ;

# Commission Rate Change Flag, Migrated System Count, Staging Count, Difference
NO, 33916, 33916, 0

~~~

### 11-Stream Status wise Policy Product count

> streamstatus目前只处理了Affnity的policy，其余的情况都为null

~~~sql
select
	streamstatus 'Stream Status',
	count(*) 'Migrated System Count',
	count(*) 'Staging Count',
	0 'Difference'
from
	topic_dmpolicyproductdetails
group by
	streamstatus ;
~~~

### 12-Renewal Flag wise Counts

~~~sql
select
	renewalfl 'Renewal Flag',
	count(*) 'Migrated System Count',
	count(*) 'Staging Count',
	0 'Difference'
from
	topic_dmpolicyheader
group by
	renewalfl ;
~~~

### 13-Product wise Count & Sum of Premium fields

~~~sql
select
	productcd 'Product Code',
	sum(modalpremiumamt) 'Adjusted Net Premium',
	sum(app) APP,
	sum(standardpremium) 'Standard Premium',
	sum(extrapremiumamt) 'Extra Premium Amt'
from
	topic_dmpolicyproductdetails
group by
	productcd ;	
~~~

### 14-Coverage Code wise  Counts

~~~sql
select
	coveragecode 'Coverage Code',
	count(*) 'Migrated System Count',
	count(*) 'Staging Count',
	0 'Difference'
from
	topic_dmpolicyproductdetails
group by
	coveragecode ;
~~~

### 15-Policy Product Submission Year wise Counts

~~~sql
select
	year(productsubmissiondate) "Year",
	count(*) 'Migrated System Count',
	count(*) 'Staging Count',
	0 'Difference'
from
	topic_dmpolicyproductdetails
group by
	year(productsubmissiondate)
order by
	year(productsubmissiondate) desc;
~~~

### 16-Policy Product Issue Date-Year wise Counts

~~~sql
select
	year(productissuedt) "Year",
	count(*) 'Migrated System Count',
	count(*) 'Staging Count',
	0 'Difference'
from
	topic_dmpolicyproductdetails
group by
	year(productissuedt)
order by
	year(productissuedt) desc;
~~~

### 17-Policy Product Commencement Date- Year wise Counts

~~~sql
select
	year(productcommencementdt) "Year",
	count(*) 'Migrated System Count',
	count(*) 'Staging Count',
	0 'Difference'
from
	topic_dmpolicyproductdetails
group by
	year(productcommencementdt)
order by
	year(productcommencementdt) desc;
~~~

### 18-Client Type Counts

~~~sql
select
	clienttype 'Client Type',
	count(*) 'Migrated System Count',
	count(*) 'Staging Count',
	0 'Difference'
from
	topic_dmpolicyclientdetails
group by
	clienttype ;
~~~

### 19-Appropriation Type wise Premium

~~~sql
select
	appropriationtypecd 'Appropriation Type',
	count(*) 'Migrated System Count',
	count(*) 'Staging Count',
	0 'Difference'
from
	topic_dmpremium
group by
	appropriationtypecd ;
~~~

### 20-Alteration Type wise Premium Counts

~~~sql
select
	alterationtype 'Alteration Type',
	count(*) 'Migrated System Count',
	count(*) 'Staging Count',
	0 'Difference'
from
	topic_dmpremium
group by
	alterationtype ;
~~~

### 21-Commission Type wise Counts

~~~sql
select
	commissiontype 'Commission Type',
	count(*) 'Migrated System Count',
	count(*) 'Staging Count',
	0 'Difference'
from
	topic_dmcommission
group by
	commissiontype ;
~~~

### 22-Appropriation Type wise Commission Counts

~~~sql
select
	appropriationtypecd 'Appropriation Type',
	commissiontype 'Commission Type',
	(case
		when fundtype = '05' then 'SIF'
		else 'OIF'
	end) Fund,
	year(commissiondate) 'Year',
	sum(commissionamt) 'Commission Amount',
	0 'Gst On Comm Amount',
	count(*) 'Migrated System Count',
	count(*) 'Staging Count',
	0 'Difference'
from
	topic_dmcommission
group by 
	appropriationtypecd ,
	commissiontype ,
	fundtype ,
	year(commissiondate);
~~~

### 23-Agent Wise Commission Type wise count and Sum of Commission amount

~~~sql
select
	c.agentcode 'Agent Code',
	c.agentcategorycode 'Designation Code(GI Category Code)',
	c.commissiontype 'Commission Type',
	(case
		when c.fundtype = '05' then 'SIF'
		else 'OIF'
	end) Fund,
	f.product_code 'Product Code',
	c.commissionstatus 'Commission Status',
	count(distinct premiumreferencenum) 'DN/CN Count' ,
	year(c.commissiondate) 'Comm Gen Dt Year',
	'NO' APPR,
	sum(c.commissionamt) 'Commission Amount',
	0 'Gst On Comm Amount',
	0 'Total Commission (Comm + GST on Comm)'
from
	topic_dmcommission c
left join topic_fee f on
	c.primarykey = f.fee_id
group by 
	c.agentcode ,
	c.agentcategorycode ,
	c.commissiontype ,
	c.fundtype ,
	f.product_code ,
	c.commissionstatus ,
	year(c.commissiondate);
~~~

​	
