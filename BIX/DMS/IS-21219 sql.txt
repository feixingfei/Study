## General policy issued to overseas customer (i.e., GL posting will be generated with Segment 6).
select
	distinct g.ma_no,g.product_code,g.dr_seg5
from
	gl_entry_split g
join trans_index t on
	g.fee_type = 'GWP'
	and g.dr_seg5 = '06'
	and g.ma_id = t.ma_id 
	and t.biz_type in ("NB","RN")
	and t.issue_date > '2023-01-01 00:00:00'
	and t.product_cate not in ('EB','AFFINITY');
# Group policy with multiple coverages (i.e., GL posting will be generated with multiple Cost Centres).
select
	distinct g.ma_no,t.product_cate,g.product_code,g.coverage_code,g.dr_seg3
from
	gl_entry_split g
join trans_index t on
	g.fee_type = 'GWP'
	and g.ma_id = t.ma_id
	and t.biz_type in ("NB","RN")
	and t.issue_date > '2023-01-01 00:00:00'
	and t.product_cate in ('EB','AFFINITY')
	and exists (select '1' from gl_entry_split g2 where g.fee_type=g2.fee_type and g.ma_no=g2.ma_no and g.dr_seg3!=g2.dr_seg3);
# General policy with multiple coverages (i.e., GL posting will be generated with multiple Cost Centres).
select
	distinct g.ma_no,t.product_cate,g.product_code,g.coverage_code,g.dr_seg3
from
	gl_entry_split g
join trans_index t on
	g.fee_type = 'GWP'
	and g.ma_id = t.ma_id
	and t.biz_type in ("NB","RN")
	and t.issue_date > '2023-01-01 00:00:00'
	and t.product_cate not in ('EB','AFFINITY')
	and exists (select '1' from gl_entry_split g2 where g.fee_type=g2.fee_type and g.ma_no=g2.ma_no and g.dr_seg3!=g2.dr_seg3);

select
	distinct g.policy_no,t.product_cate,g.product_code,g.coverage_code,g.dr_seg3
from
	gl_entry_split g
join trans_index t on
	g.fee_type = 'GWP'
	and g.policy_id = t.policy_id
	and t.biz_type in ("NB","RN")
	and t.issue_date > '2023-01-01 00:00:00'
	and t.product_cate not in ('EB','AFFINITY')
	and t.ma_id is null
	and exists (select '1' from gl_entry_split g2 where g.fee_type=g2.fee_type and g.ma_no=g2.ma_no and g.dr_seg3!=g2.dr_seg3);

select ma_no,product_code,coverage_code,fee_type,dr_seg3,dr_seg5 from gl_entry_split where fee_type = 'GWP' and ma_no = "2000030877";